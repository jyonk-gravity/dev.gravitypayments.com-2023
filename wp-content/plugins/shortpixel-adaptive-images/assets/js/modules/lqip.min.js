function LQIP(){var t=this;var n=typeof window.lqipConstants==="undefined"?5:typeof window.lqipConstants.processWay==="string"?window.lqipConstants.processWay==="cron"?20:5:5;var e=typeof window.lqipConstants==="undefined"?false:typeof window.lqipConstants.localStorage==="undefined"?false:!!window.lqipConstants.localStorage;this.await=0;this.collection=[];this.OID=undefined;this.ajax=false;this.responses=[];this.add=function(t,e){var i=this.exists(t),o=this.getExtension(t);if(o!=="svg"&&!i){this.collection.push({url:t,source:e,sent:false})}this.filter();this.count();if(this.await>=n){this.send()}};this.send=function(){if(this.ajax){return}var e=new FormData,i=new XMLHttpRequest,o=typeof spai_settings==="undefined"?"wp-admin/admin-ajax.php":spai_settings.ajax_url;e.append("action",typeof window.lqipConstants==="object"&&(typeof window.lqipConstants.action==="string"&&window.lqipConstants.action!=="")?window.lqipConstants.action:"shortpixel_ai_handle_lqip_action");e.append("data[action]","collect");e.append("data[referer]",window.location.href);if(this.collection.length>0){var s=0;for(var a=0,l=this.collection[a];a<this.collection.length;l=this.collection[++a]){if(!l.sent){e.append("data[collection]["+s+"][url]",l.url);e.append("data[collection]["+s+"][source]",l.source);this.collection[a].toSend=true;s++}if(s>=n){break}}}i.timeout=2e4;i.open("post",o);i.onload=function(){var n;try{n=JSON.parse(i.response)}catch(t){n={success:false};console.log(t)}t.responses.push(n);t.collection.forEach((function(t){if(t.toSend){t.sent=n.success;delete t.toSend}}));if(n.success){t.ajax=false;t.count();t.store()}};i.onloadend=function(){t.ajax=false};this.ajax=true;i.send(e)};this.filter=function(){this.collection=this.collection.filter((function(t,n,e){var i=true;if(e.length>1){e.forEach((function(e,o){var s=0;if(n!==o){if(t.url===e.url)s++}i=s===0}))}return i}))};this.count=function(){if(this.collection.length>0){this.await=0;for(var t=0;t<this.collection.length;t++){if(this.await<this.collection.length&&!this.collection[t].sent){this.await++}}}};this.store=function(){if(!localStorage instanceof Storage||!e){return false}try{var n=JSON.parse(localStorage.lqipCollection)}catch(t){n=[]}n.concat(t.collection);t.filter();t.count();localStorage.lqipCollection=JSON.stringify(t.collection);return true};this.exists=function(t){if(this.collection.length>0){for(var n=0;n<this.collection.length;n++){if(this.collection[n].url===t){return true}}}return false};this.getExtension=function(t){var n=/(?:\.([^.\/\?]+))(?:$|\?.*)/;n.lastIndex=0;var e=n.exec(t),i=typeof e==="object"&&e!==null&&typeof e[1]==="string"&&e[1]!==""?e[1]:undefined;return i==="jpeg"?"jpg":i};(this.observer=function(n){n=parseInt(n,10);n=isNaN(n)?5e3:n;if(t.await>0){t.send()}if(!t.OID){t.OID=setInterval(t.observer,n)}})();(this.retrieve=function(){if(!localStorage instanceof Storage||!e){return false}try{var n=JSON.parse(localStorage.lqipCollection)}catch(t){n=[]}t.collection=t.collection.concat(n);t.filter();t.count();return true})()}