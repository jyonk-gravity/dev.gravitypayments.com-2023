(()=>{"use strict";var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var n in s)e.o(s,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:s[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{FIRST_WP_VERSION_WITH_THUNK_SUPPORT:()=>w,INITIAL_STATE:()=>o,QLSE_REST_ROUTES:()=>E,QUADLAYERS_QLSE_STORE_NAME:()=>k,STORE_NAME:()=>r,WP_VERSION:()=>h,actions:()=>n,applyThunkMiddleware:()=>_,fetchRestApiSettings:()=>v,isVersionLessThan:()=>D,reducer:()=>a,resolvers:()=>i,selectors:()=>s,useDisplaySettings:()=>x,useExcludedSettings:()=>R});var s={};e.r(s),e.d(s,{getSettingsDisplay:()=>c,getSettingsExcluded:()=>l});var n={};e.r(n),e.d(n,{saveDisplaySettings:()=>m,saveExcludedSettings:()=>P,saveSettings:()=>b,setSettingsDisplay:()=>O,setSettingsExcluded:()=>T});var i={};e.r(i),e.d(i,{getSettingsDisplay:()=>A,getSettingsExcluded:()=>j});var a={};e.r(a),e.d(a,{default:()=>N,display:()=>I,excluded:()=>L});const d=window.wp.data,r="qlse/settings",o={display:{devices:"all",target:{include:1,ids:[]},entries:{post:{include:1,ids:[]},page:{include:1,ids:[]}},taxonomies:{category:{include:1,ids:[]},tags:{include:1,ids:[]},product_cat:{include:1,ids:[]}}},excluded:[]},c=e=>e.display,l=e=>e.excluded,u=window.wp.i18n,g=window.wp.notices,p=window.wp.apiFetch;var S=e.n(p);const y=window.wp.url,{QLSE_REST_ROUTES:E,WP_VERSION:h}=qlseStore,w="6.0",v=({method:e,data:t,route:s}={})=>async function(e){return await S()(e).then((e=>{if(e.code)throw e;return e})).catch((e=>e?.data?.params&&e?.data?.status?{code:e.data.status,message:Object.values(e.data.params)[0]}:{code:e?.code?e.code:"Unknown",message:e?.message?e.message:"Unknown"}))}({path:"GET"===e?(0,y.addQueryArgs)(E[s],t):E[s],method:e,data:t});function x(){const{setSettingsDisplay:e,saveDisplaySettings:t}=(0,d.useDispatch)(r),{settingsDisplay:s,isResolvingSettingsDisplay:n,hasResolvedSettingsDisplay:i}=(0,d.useSelect)((e=>{const{getSettingsDisplay:t,isResolving:s,hasFinishedResolution:n}=e(r);return{settingsDisplay:t(),isResolvingSettingsDisplay:s("getSettingsDisplay"),hasResolvedSettingsDisplay:n("getSettingsDisplay")}}),[]);return{settingsDisplay:s,isResolvingSettingsDisplay:n,hasResolvedSettingsDisplay:i,hasSettingsDisplay:!(!i||!Object.keys(s)?.length),saveDisplaySettings:t,setSettingsDisplay:e}}function R(){const{setSettingsExcluded:e,saveExcludedSettings:t}=(0,d.useDispatch)(r),{settingsExcluded:s,isResolvingSettingsExcluded:n,hasResolvedSettingsExcluded:i}=(0,d.useSelect)((e=>{const{getSettingsExcluded:t,isResolving:s,hasFinishedResolution:n}=e(r);return{settingsExcluded:t(),isResolvingSettingsExcluded:s("getSettingsExcluded"),hasResolvedSettingsExcluded:n("getSettingsExcluded")}}),[]);return{settingsExcluded:s,isResolvingSettingsExcluded:n,hasResolvedSettingsExcluded:i,hasSettingsExcluded:!(!i||!Object.keys(s)?.length),saveExcludedSettings:t,setSettingsExcluded:e}}const D=(e,t)=>{const s=e.split(".").map(Number),n=t.split(".").map(Number);for(let e=0;e<n.length;e++){if(s[e]<n[e])return!0;if(s[e]>n[e])return!1}return!1},_=e=>{const t=e.instantiate;return e.instantiate=e=>{const s=t(e);if(!s.store||!s.store.dispatch)throw new Error((0,u.__)("The created instance does not contain a valid store.","search-exclude"));const n=s.store.dispatch,i=((e,t)=>({registry:t,get dispatch(){return Object.assign((t=>e.store.dispatch(t)),e.getActions())},get select(){return Object.assign((t=>t(e.store.__unstableOriginalGetState())),e.getSelectors())},get resolveSelect(){return e.getResolveSelectors()}}))(s,e);return s.store.dispatch=((e,t)=>s=>"function"==typeof s?s(e):t(s))(i,n),s},e};function f(e,t){const s={};return new Set([...Object.keys(e),...Object.keys(t)]).forEach((n=>{e.hasOwnProperty(n)&&t.hasOwnProperty(n)?!function(e){const t=typeof e;return null!=e&&("object"==t||"function"==t)}(e[n])||Array.isArray(e[n])?s[n]=t[n]:s[n]=f(e[n],t[n]):e.hasOwnProperty(n)?s[n]=e[n]:t.hasOwnProperty(n)&&(s[n]=t[n])})),s}const O=e=>({type:"SET_DISPLAY",payload:t=>f(t,e)}),T=e=>(console.log("newSettings: ",e),{type:"SET_EXCLUDED",payload:()=>e}),b=(e,t)=>async({registry:s,dispatch:n,select:i})=>{let a;if(!t)throw new Error("Route is required.");switch(t){case"excluded":a={...i.getSettingsDisplay(),excluded:e};break;case"display":a={...i.getSettingsExcluded(),display:e}}const d=t.charAt(0).toUpperCase()+t.slice(1),r=await v({method:"POST",data:a,route:t});return r?.code?(s.dispatch(g.store).createSuccessNotice((0,u.sprintf)("%s: %s",r.code,r.message),{type:"snackbar"}),!1):(n[`setSettings${d}`](e),!0)},m=e=>b(e,"display"),P=e=>b(e,"excluded"),A=async()=>{try{const e=await v({route:"display"});return O(e)}catch(e){console.error(e)}},j=async()=>{try{const e=await v({route:"excluded"});return T(e?.excluded)}catch(e){console.error(e)}};function I(e=o.display,t){return"SET_DISPLAY"===t.type?t.payload(e):e}function L(e=o.excluded,t){return"SET_EXCLUDED"===t.type?t.payload(e):e}const N=(0,d.combineReducers)({display:I,excluded:L}),U=(0,d.createReduxStore)(r,{reducer:N,actions:n,selectors:s,resolvers:i});(0,d.register)(D(h,w)?_(U):U);const k=r;(window.qlse=window.qlse||{}).store=t})();