{"version":3,"sources":["webpack://gravityformsrecaptcha/./js/src/frontend.js","webpack://gravityformsrecaptcha/webpack/startup"],"names":["$","gform","grecaptcha","strings","getToken","e","form","data","recaptchaField","find","dataInput","length","val","preventDefault","ready","execute","site_key","action","then","token","$submitButton","dataset","formid","prop","submit","addFormEventListeners","formId","$form","on","addClass","gfRecaptcha","self","init","elements","formIds","getFormIds","addEventListeners","ids","forms","document","querySelectorAll","forEach","push","getAttribute","split","event","jQuery","gforms_recaptcha_recaptcha_strings"],"mappings":"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","file":"./js/frontend.js","sourcesContent":["/* global jQuery, gform, gforms_recaptcha_recaptcha_strings, grecaptcha */\n( ( $, gform, grecaptcha, strings ) => {\n\t/**\n\t * Make the API request to Google to get the reCAPTCHA token right before submission.\n\t *\n\t * @since 1.0\n\t *\n\t * @param {Object} e The event object.\n\t * @return {void}\n\t */\n\tconst getToken = ( e ) => {\n\t\tconst form = $( e.data.form );\n\t\tconst recaptchaField = form.find( '.ginput_recaptchav3' );\n\t\tconst dataInput = recaptchaField.find( '.gfield_recaptcha_response' );\n\n\t\tif ( ! dataInput.length || dataInput.val().length ) {\n\t\t\treturn;\n\t\t}\n\n\t\te.preventDefault();\n\n\t\tgrecaptcha.ready( () => {\n\t\t\tgrecaptcha.execute( strings.site_key, { action: 'submit' } )\n\t\t\t\t.then( ( token ) => {\n\t\t\t\t\tif ( token.length && typeof token === 'string' ) {\n\t\t\t\t\t\tdataInput.val( token );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Sometimes the submit button is disabled to prevent the user from clicking it again,\n\t\t\t\t\t// for example when 3DS is being processed for stripe elements.\n\t\t\t\t\t// We need to enable it before submitting the form, otherwise it won't be submitted.\n\t\t\t\t\tconst $submitButton = $( '#gform_submit_button_' + form[0].dataset.formid );\n\t\t\t\t\tif ( $submitButton.prop( 'disabled' ) === true ) {\n\t\t\t\t\t\t$submitButton.prop( 'disabled', false );\n\t\t\t\t\t}\n\n\t\t\t\t\tform.submit();\n\t\t\t\t} );\n\t\t} );\n\t};\n\n\t/**\n\t * Add event listeners to the form.\n\t *\n\t * @since 1.0\n\t *\n\t * @param {string|number} formId The numeric ID of the form.\n\t * @return {void}\n\t */\n\tconst addFormEventListeners = ( formId ) => {\n\t\tconst $form = $( `#gform_${ formId }:not(.recaptcha-v3-initialized)` );\n\n\t\t$form.on( 'submit', { form: $form }, getToken );\n\n\t\t$form.addClass( 'recaptcha-v3-initialized' );\n\t};\n\n\t/**\n\t * The reCAPTCHA handler.\n\t *\n\t * @since 1.0\n\t *\n\t * @return {void}\n\t */\n\tconst gfRecaptcha = () => {\n\t\tconst self = this;\n\n\t\t/**\n\t\t * Initialize the Recaptcha handler.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tself.init = () => {\n\t\t\tself.elements = {\n\t\t\t\tformIds: self.getFormIds(),\n\t\t\t};\n\t\t\tself.addEventListeners();\n\t\t};\n\n\t\t/**\n\t\t * Get an array of form IDs.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {Array} Array of form IDs.\n\t\t */\n\t\tself.getFormIds = () => {\n\t\t\tconst ids = [];\n\t\t\tconst forms = document.querySelectorAll( '.gform_wrapper form' );\n\n\t\t\tforms.forEach( ( form ) => {\n\t\t\t\tif ( 'formid' in form.dataset ) {\n\t\t\t\t\tids.push( form.dataset.formid );\n\t\t\t\t} else {\n\t\t\t\t\tids.push( form.getAttribute( 'id' ).split( 'gform_' )[ 1 ] );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\treturn ids;\n\t\t};\n\n\t\t/**\n\t\t * Add event listeners to the page.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tself.addEventListeners = () => {\n\t\t\tself.elements.formIds.forEach( ( formId ) => {\n\t\t\t\taddFormEventListeners( formId );\n\t\t\t} );\n\n\t\t\t$( document ).on( 'gform_post_render', ( event, formId ) => {\n\t\t\t\taddFormEventListeners( formId );\n\t\t\t} );\n\t\t};\n\n\t\tself.init();\n\t};\n\n\t// Initialize and run the whole shebang.\n\t$( document ).ready( () => {\n\t\tgfRecaptcha();\n\t} );\n} )( jQuery, gform, grecaptcha, gforms_recaptcha_recaptcha_strings );\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = {};\n__webpack_modules__[\"./js/src/frontend.js\"]();\n"],"sourceRoot":""}