(()=>{var e={309(e){"use strict";e.exports=window.wp.editPost},452(e){var t=function(e){"use strict";var t,n=Object.prototype,o=n.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function l(e,t,n,o){var i=t&&t.prototype instanceof w?t:w,a=Object.create(i.prototype),s=new C(o||[]);return r(a,"_invoke",{value:T(e,n,s)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var p="suspendedStart",d="suspendedYield",h="executing",m="completed",y={};function w(){}function b(){}function g(){}var v={};u(v,a,function(){return this});var S=Object.getPrototypeOf,_=S&&S(S(A([])));_&&_!==n&&o.call(_,a)&&(v=_);var k=g.prototype=w.prototype=Object.create(v);function E(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function P(e,t){function n(r,i,a,s){var c=f(e[r],e,i);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==typeof l&&o.call(l,"__await")?t.resolve(l.__await).then(function(e){n("next",e,a,s)},function(e){n("throw",e,a,s)}):t.resolve(l).then(function(e){u.value=e,a(u)},function(e){return n("throw",e,a,s)})}s(c.arg)}var i;r(this,"_invoke",{value:function(e,o){function r(){return new t(function(t,r){n(e,o,t,r)})}return i=i?i.then(r,r):r()}})}function T(e,n,o){var r=p;return function(i,a){if(r===h)throw new Error("Generator is already running");if(r===m){if("throw"===i)throw a;return{value:t,done:!0}}for(o.method=i,o.arg=a;;){var s=o.delegate;if(s){var c=O(s,o);if(c){if(c===y)continue;return c}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(r===p)throw r=m,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);r=h;var u=f(e,n,o);if("normal"===u.type){if(r=o.done?m:d,u.arg===y)continue;return{value:u.arg,done:o.done}}"throw"===u.type&&(r=m,o.method="throw",o.arg=u.arg)}}}function O(e,n){var o=n.method,r=e.iterator[o];if(r===t)return n.delegate=null,"throw"===o&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==o&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+o+"' method")),y;var i=f(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function A(e){if(null!=e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function n(){for(;++r<e.length;)if(o.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(typeof e+" is not iterable")}return b.prototype=g,r(k,"constructor",{value:g,configurable:!0}),r(g,"constructor",{value:b,configurable:!0}),b.displayName=u(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,c,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},E(P.prototype),u(P.prototype,s,function(){return this}),e.AsyncIterator=P,e.async=function(t,n,o,r,i){void 0===i&&(i=Promise);var a=new P(l(t,n,o,r),i);return e.isGeneratorFunction(n)?a:a.next().then(function(e){return e.done?e.value:a.next()})},E(k),u(k,c,"Generator"),u(k,a,function(){return this}),u(k,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(o,r){return s.type="throw",s.arg=e,n.next=o,r&&(n.method="next",n.arg=t),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),D(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var r=o.arg;D(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,o){return this.delegate={iterator:A(e),resultName:n,nextLoc:o},"next"===this.method&&(this.arg=t),y}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},656(e){"use strict";e.exports=window.wp.editor}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};n.r(e),n.d(e,{getDueDate:()=>P,getOWSettings:()=>T,getPostInWorkflow:()=>R,getUserCapabilities:()=>O});var t={};n.r(t),n.d(t,{fetchOWSettings:()=>C,fetchUserCapabilities:()=>I,setDueDate:()=>D,setIsPostInWorkflow:()=>N,setOWSettings:()=>A,setUserCapabilities:()=>j}),n(452);const o=window.wp.i18n,r=window.wp.element;function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){return t.reduce(function(t,n){return e.hasOwnProperty(n)&&(t[n]=e[n]),t},{})}function s(e){return null==e||0===e.length||"object"===i(e)&&0===Object.keys(e).length}function c(){var e=new URLSearchParams(window.location.search);if(null==(e=e.get("oasiswf"))){var t=document.getElementById("hi_oasiswf_id");return void 0===t||null==t?null:t.value}return e}function u(){return new URLSearchParams(window.location.search).get("user")}function l(e){var t=[],n=(0,o.__)("Complete","oasisworkflow"),r=(0,o.__)("Unable to Complete","oasisworkflow");return"review"==e&&(n=(0,o.__)("Approved","oasisworkflow"),r=(0,o.__)("Reject","oasisworkflow")),t.push({label:"",value:""},{label:n,value:"complete"},{label:r,value:"unable"}),t}function f(e){for(var t=e.assignees,n=[],o=[],r=e.assignToAll,i="",s=0;s<t.length;s++)-1!==t[s].name.indexOf("Post Author")&&(i=t[s]);t.sort(function(e,t){return e===i?-1:t===i?1:0});var c=t.map(function(e){return a(e,["ID","name"])});if(c.map(function(e){n.push({label:e.name,value:e.ID})}),1==n.length&&(o=[n[0].value]),r){var u=[];c.map(function(e){u.push(e.ID)}),o=u}return{availableAssignees:n,selectedAssignees:o}}var p=(0,r.createElement)("svg",{width:20,height:20},(0,r.createElement)("path",{d:"M20,11.647c0-5.204-4.478-9.424-10-9.424c-5.523,0-10,4.22-10,9.424c0,0.594,0.061,1.174,0.172,1.734c0.077-5.232,4.371-9.449,9.659-9.449c5.337,0,9.664,4.295,9.664,9.593c0,0.182-0.008,0.362-0.019,0.541l0.199-0.037C19.886,13.268,20,12.47,20,11.647z"}),(0,r.createElement)("polygon",{points:"7.471,9.916 9.197,12.597 6.949,18 3.876,18 \t"}),(0,r.createElement)("polygon",{points:"15.553,10.996 12.732,18 15.911,18 17.868,12.219 \t"}),(0,r.createElement)("polygon",{points:"14.355,11.07 17.818,8.699 18.838,12.771 \t"}),(0,r.createElement)("polygon",{points:"7.484,9.762 10.317,9.767 15.911,17.674 12.74,17.674 \t"}),(0,r.createElement)("polygon",{points:"0.379,12.984 1.659,9.94 6.964,17.674 3.876,17.674 \t"}));const d=window.wp.data,h=window.wp.apiFetch;var m=n.n(h);function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach(function(t){g(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function g(e,t,n){return(t=function(e){var t=function(e){if("object"!=y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==y(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v={dueDate:new Date},S={owSettings:{}},_={userCap:{}},k={isPostInWorkflow:!1};const E=(0,d.combineReducers)({dueDateReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;return"SET_DUE_DATE"===t.type?b(b({},e),{},{dueDate:t.dueDate}):e},owSettingsReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;return"SET_OW_SETTINGS"===t.type?b(b({},e),{},{owSettings:t.owSettings}):e},userCapabilitiesReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;return"SET_USER_CAPABILITIES"===t.type?b(b({},e),{},{userCap:t.userCap}):e},postInWorkflowReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;return"SET_POST_IS_IN_WORKFLOW"===t.type?b(b({},e),{},{isPostInWorkflow:t.isPostInWorkflow}):e}});function P(e){return e.dueDateReducer.dueDate}function T(e){return e.owSettingsReducer.owSettings}function O(e){return e.userCapabilitiesReducer.userCap}function R(e){return e.postInWorkflowReducer.isPostInWorkflow}function D(e){return{type:"SET_DUE_DATE",dueDate:e.dueDate}}function C(e){return{type:"FETCH_OW_SETTINGS",path:e}}function A(e){return{type:"SET_OW_SETTINGS",owSettings:e}}function I(e){return{type:"FETCH_USER_CAPABILITIES",path:e}}function j(e){return{type:"SET_USER_CAPABILITIES",userCap:e}}function N(e){var t=!1;return"1"==e.isPostInWorkflow&&(t=!0),{type:"SET_POST_IS_IN_WORKFLOW",isPostInWorkflow:t}}function x(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function i(n,o,r,i){var c=o&&o.prototype instanceof s?o:s,u=Object.create(c.prototype);return L(u,"_invoke",function(n,o,r){var i,s,c,u=0,l=r||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,s=0,c=e,p.n=n,a}};function d(n,o){for(s=n,c=o,t=0;!f&&u&&!r&&t<l.length;t++){var r,i=l[t],d=p.p,h=i[2];n>3?(r=h===o)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=d&&((r=n<2&&d<i[1])?(s=0,p.v=o,p.n=i[1]):d<h&&(r=n<3||i[0]>o||o>h)&&(i[4]=n,i[5]=o,p.n=h,s=0))}if(r||n>1)return a;throw f=!0,o}return function(r,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),s=l,c=h;(t=s<2?e:c)||!f;){i||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,i){if(s||(r="next"),t=i[r]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),s=1);i=e}else if((t=(f=p.n<0)?c:n.call(o,p))!==a)break}catch(t){i=e,s=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,r,i),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][o]?t(t([][o]())):(L(t={},o,function(){return this}),t),f=u.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,L(e,r,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,L(f,"constructor",u),L(u,"constructor",c),c.displayName="GeneratorFunction",L(u,r,"GeneratorFunction"),L(f),L(f,r,"Generator"),L(f,o,function(){return this}),L(f,"toString",function(){return"[object Generator]"}),(x=function(){return{w:i,m:p}})()}function L(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}L=function(e,t,n,o){function i(t,n){L(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},L(e,t,n,o)}var B=(0,d.createReduxStore)("plugin/oasis-workflow",{reducer:E,selectors:e,actions:t,controls:{FETCH_OW_SETTINGS:function(e){return m()({path:e.path})},FETCH_USER_CAPABILITIES:function(e){return m()({path:e.path})}},resolvers:{getOWSettings:x().m(function e(){var t;return x().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,C("/oasis-workflow/v1/settings");case 1:return t=e.v,e.a(2,A(t))}},e)}),getUserCapabilities:x().m(function e(){var t;return x().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,I("/oasis-workflow/v1/usercap");case 1:return t=e.v,e.a(2,j(t))}},e)})}});(0,d.register)(B);const M=window.wp.compose,W=window.wp.components,F=window.wp.plugins,{entries:U,setPrototypeOf:G,isFrozen:H,getPrototypeOf:z,getOwnPropertyDescriptor:Y}=Object;let{freeze:Q,seal:q,create:V}=Object,{apply:X,construct:$}="undefined"!=typeof Reflect&&Reflect;Q||(Q=function(e){return e}),q||(q=function(e){return e}),X||(X=function(e,t){for(var n=arguments.length,o=new Array(n>2?n-2:0),r=2;r<n;r++)o[r-2]=arguments[r];return e.apply(t,o)}),$||($=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return new e(...n)});const K=pe(Array.prototype.forEach),Z=pe(Array.prototype.lastIndexOf),J=pe(Array.prototype.pop),ee=pe(Array.prototype.push),te=pe(Array.prototype.splice),ne=pe(String.prototype.toLowerCase),oe=pe(String.prototype.toString),re=pe(String.prototype.match),ie=pe(String.prototype.replace),ae=pe(String.prototype.indexOf),se=pe(String.prototype.trim),ce=pe(Object.prototype.hasOwnProperty),ue=pe(RegExp.prototype.test),le=(fe=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return $(fe,t)});var fe;function pe(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];return X(e,t,o)}}function de(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ne;G&&G(e,null);let o=t.length;for(;o--;){let r=t[o];if("string"==typeof r){const e=n(r);e!==r&&(H(t)||(t[o]=e),r=e)}e[r]=!0}return e}function he(e){for(let t=0;t<e.length;t++)ce(e,t)||(e[t]=null);return e}function me(e){const t=V(null);for(const[n,o]of U(e))ce(e,n)&&(Array.isArray(o)?t[n]=he(o):o&&"object"==typeof o&&o.constructor===Object?t[n]=me(o):t[n]=o);return t}function ye(e,t){for(;null!==e;){const n=Y(e,t);if(n){if(n.get)return pe(n.get);if("function"==typeof n.value)return pe(n.value)}e=z(e)}return function(){return null}}const we=Q(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),be=Q(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ge=Q(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ve=Q(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Se=Q(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),_e=Q(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),ke=Q(["#text"]),Ee=Q(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Pe=Q(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Te=Q(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Oe=Q(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Re=q(/\{\{[\w\W]*|[\w\W]*\}\}/gm),De=q(/<%[\w\W]*|[\w\W]*%>/gm),Ce=q(/\$\{[\w\W]*/gm),Ae=q(/^data-[\-\w.\u00B7-\uFFFF]+$/),Ie=q(/^aria-[\-\w]+$/),je=q(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Ne=q(/^(?:\w+script|data):/i),xe=q(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Le=q(/^html$/i),Be=q(/^[a-z][.\w]*(-[.\w]+)+$/i);var Me=Object.freeze({__proto__:null,ARIA_ATTR:Ie,ATTR_WHITESPACE:xe,CUSTOM_ELEMENT:Be,DATA_ATTR:Ae,DOCTYPE_NAME:Le,ERB_EXPR:De,IS_ALLOWED_URI:je,IS_SCRIPT_OR_DATA:Ne,MUSTACHE_EXPR:Re,TMPLIT_EXPR:Ce});const We=function(){return"undefined"==typeof window?null:window};var Fe=function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We();const n=t=>e(t);if(n.version="3.3.1",n.removed=[],!t||!t.document||9!==t.document.nodeType||!t.Element)return n.isSupported=!1,n;let{document:o}=t;const r=o,i=r.currentScript,{DocumentFragment:a,HTMLTemplateElement:s,Node:c,Element:u,NodeFilter:l,NamedNodeMap:f=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:p,DOMParser:d,trustedTypes:h}=t,m=u.prototype,y=ye(m,"cloneNode"),w=ye(m,"remove"),b=ye(m,"nextSibling"),g=ye(m,"childNodes"),v=ye(m,"parentNode");if("function"==typeof s){const e=o.createElement("template");e.content&&e.content.ownerDocument&&(o=e.content.ownerDocument)}let S,_="";const{implementation:k,createNodeIterator:E,createDocumentFragment:P,getElementsByTagName:T}=o,{importNode:O}=r;let R={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};n.isSupported="function"==typeof U&&"function"==typeof v&&k&&void 0!==k.createHTMLDocument;const{MUSTACHE_EXPR:D,ERB_EXPR:C,TMPLIT_EXPR:A,DATA_ATTR:I,ARIA_ATTR:j,IS_SCRIPT_OR_DATA:N,ATTR_WHITESPACE:x,CUSTOM_ELEMENT:L}=Me;let{IS_ALLOWED_URI:B}=Me,M=null;const W=de({},[...we,...be,...ge,...Se,...ke]);let F=null;const G=de({},[...Ee,...Pe,...Te,...Oe]);let H=Object.seal(V(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),z=null,Y=null;const q=Object.seal(V(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let X=!0,$=!0,fe=!1,pe=!0,he=!1,Re=!0,De=!1,Ce=!1,Ae=!1,Ie=!1,Ne=!1,xe=!1,Be=!0,Fe=!1,Ue=!0,Ge=!1,He={},ze=null;const Ye=de({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Qe=null;const qe=de({},["audio","video","img","source","image","track"]);let Ve=null;const Xe=de({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),$e="http://www.w3.org/1998/Math/MathML",Ke="http://www.w3.org/2000/svg",Ze="http://www.w3.org/1999/xhtml";let Je=Ze,et=!1,tt=null;const nt=de({},[$e,Ke,Ze],oe);let ot=de({},["mi","mo","mn","ms","mtext"]),rt=de({},["annotation-xml"]);const it=de({},["title","style","font","a","script"]);let at=null;const st=["application/xhtml+xml","text/html"];let ct=null,ut=null;const lt=o.createElement("form"),ft=function(e){return e instanceof RegExp||e instanceof Function},pt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!ut||ut!==e){if(e&&"object"==typeof e||(e={}),e=me(e),at=-1===st.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,ct="application/xhtml+xml"===at?oe:ne,M=ce(e,"ALLOWED_TAGS")?de({},e.ALLOWED_TAGS,ct):W,F=ce(e,"ALLOWED_ATTR")?de({},e.ALLOWED_ATTR,ct):G,tt=ce(e,"ALLOWED_NAMESPACES")?de({},e.ALLOWED_NAMESPACES,oe):nt,Ve=ce(e,"ADD_URI_SAFE_ATTR")?de(me(Xe),e.ADD_URI_SAFE_ATTR,ct):Xe,Qe=ce(e,"ADD_DATA_URI_TAGS")?de(me(qe),e.ADD_DATA_URI_TAGS,ct):qe,ze=ce(e,"FORBID_CONTENTS")?de({},e.FORBID_CONTENTS,ct):Ye,z=ce(e,"FORBID_TAGS")?de({},e.FORBID_TAGS,ct):me({}),Y=ce(e,"FORBID_ATTR")?de({},e.FORBID_ATTR,ct):me({}),He=!!ce(e,"USE_PROFILES")&&e.USE_PROFILES,X=!1!==e.ALLOW_ARIA_ATTR,$=!1!==e.ALLOW_DATA_ATTR,fe=e.ALLOW_UNKNOWN_PROTOCOLS||!1,pe=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,he=e.SAFE_FOR_TEMPLATES||!1,Re=!1!==e.SAFE_FOR_XML,De=e.WHOLE_DOCUMENT||!1,Ie=e.RETURN_DOM||!1,Ne=e.RETURN_DOM_FRAGMENT||!1,xe=e.RETURN_TRUSTED_TYPE||!1,Ae=e.FORCE_BODY||!1,Be=!1!==e.SANITIZE_DOM,Fe=e.SANITIZE_NAMED_PROPS||!1,Ue=!1!==e.KEEP_CONTENT,Ge=e.IN_PLACE||!1,B=e.ALLOWED_URI_REGEXP||je,Je=e.NAMESPACE||Ze,ot=e.MATHML_TEXT_INTEGRATION_POINTS||ot,rt=e.HTML_INTEGRATION_POINTS||rt,H=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&ft(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(H.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&ft(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(H.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(H.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),he&&($=!1),Ne&&(Ie=!0),He&&(M=de({},ke),F=[],!0===He.html&&(de(M,we),de(F,Ee)),!0===He.svg&&(de(M,be),de(F,Pe),de(F,Oe)),!0===He.svgFilters&&(de(M,ge),de(F,Pe),de(F,Oe)),!0===He.mathMl&&(de(M,Se),de(F,Te),de(F,Oe))),e.ADD_TAGS&&("function"==typeof e.ADD_TAGS?q.tagCheck=e.ADD_TAGS:(M===W&&(M=me(M)),de(M,e.ADD_TAGS,ct))),e.ADD_ATTR&&("function"==typeof e.ADD_ATTR?q.attributeCheck=e.ADD_ATTR:(F===G&&(F=me(F)),de(F,e.ADD_ATTR,ct))),e.ADD_URI_SAFE_ATTR&&de(Ve,e.ADD_URI_SAFE_ATTR,ct),e.FORBID_CONTENTS&&(ze===Ye&&(ze=me(ze)),de(ze,e.FORBID_CONTENTS,ct)),e.ADD_FORBID_CONTENTS&&(ze===Ye&&(ze=me(ze)),de(ze,e.ADD_FORBID_CONTENTS,ct)),Ue&&(M["#text"]=!0),De&&de(M,["html","head","body"]),M.table&&(de(M,["tbody"]),delete z.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw le('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw le('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');S=e.TRUSTED_TYPES_POLICY,_=S.createHTML("")}else void 0===S&&(S=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let n=null;const o="data-tt-policy-suffix";t&&t.hasAttribute(o)&&(n=t.getAttribute(o));const r="dompurify"+(n?"#"+n:"");try{return e.createPolicy(r,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+r+" could not be created."),null}}(h,i)),null!==S&&"string"==typeof _&&(_=S.createHTML(""));Q&&Q(e),ut=e}},dt=de({},[...be,...ge,...ve]),ht=de({},[...Se,..._e]),mt=function(e){ee(n.removed,{element:e});try{v(e).removeChild(e)}catch(t){w(e)}},yt=function(e,t){try{ee(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){ee(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(Ie||Ne)try{mt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},wt=function(e){let t=null,n=null;if(Ae)e="<remove></remove>"+e;else{const t=re(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===at&&Je===Ze&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const r=S?S.createHTML(e):e;if(Je===Ze)try{t=(new d).parseFromString(r,at)}catch(e){}if(!t||!t.documentElement){t=k.createDocument(Je,"template",null);try{t.documentElement.innerHTML=et?_:r}catch(e){}}const i=t.body||t.documentElement;return e&&n&&i.insertBefore(o.createTextNode(n),i.childNodes[0]||null),Je===Ze?T.call(t,De?"html":"body")[0]:De?t.documentElement:i},bt=function(e){return E.call(e.ownerDocument||e,e,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT|l.SHOW_PROCESSING_INSTRUCTION|l.SHOW_CDATA_SECTION,null)},gt=function(e){return e instanceof p&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof f)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},vt=function(e){return"function"==typeof c&&e instanceof c};function St(e,t,o){K(e,e=>{e.call(n,t,o,ut)})}const _t=function(e){let t=null;if(St(R.beforeSanitizeElements,e,null),gt(e))return mt(e),!0;const o=ct(e.nodeName);if(St(R.uponSanitizeElement,e,{tagName:o,allowedTags:M}),Re&&e.hasChildNodes()&&!vt(e.firstElementChild)&&ue(/<[/\w!]/g,e.innerHTML)&&ue(/<[/\w!]/g,e.textContent))return mt(e),!0;if(7===e.nodeType)return mt(e),!0;if(Re&&8===e.nodeType&&ue(/<[/\w]/g,e.data))return mt(e),!0;if(!(q.tagCheck instanceof Function&&q.tagCheck(o))&&(!M[o]||z[o])){if(!z[o]&&Et(o)){if(H.tagNameCheck instanceof RegExp&&ue(H.tagNameCheck,o))return!1;if(H.tagNameCheck instanceof Function&&H.tagNameCheck(o))return!1}if(Ue&&!ze[o]){const t=v(e)||e.parentNode,n=g(e)||e.childNodes;if(n&&t)for(let o=n.length-1;o>=0;--o){const r=y(n[o],!0);r.__removalCount=(e.__removalCount||0)+1,t.insertBefore(r,b(e))}}return mt(e),!0}return e instanceof u&&!function(e){let t=v(e);t&&t.tagName||(t={namespaceURI:Je,tagName:"template"});const n=ne(e.tagName),o=ne(t.tagName);return!!tt[e.namespaceURI]&&(e.namespaceURI===Ke?t.namespaceURI===Ze?"svg"===n:t.namespaceURI===$e?"svg"===n&&("annotation-xml"===o||ot[o]):Boolean(dt[n]):e.namespaceURI===$e?t.namespaceURI===Ze?"math"===n:t.namespaceURI===Ke?"math"===n&&rt[o]:Boolean(ht[n]):e.namespaceURI===Ze?!(t.namespaceURI===Ke&&!rt[o])&&!(t.namespaceURI===$e&&!ot[o])&&!ht[n]&&(it[n]||!dt[n]):!("application/xhtml+xml"!==at||!tt[e.namespaceURI]))}(e)?(mt(e),!0):"noscript"!==o&&"noembed"!==o&&"noframes"!==o||!ue(/<\/no(script|embed|frames)/i,e.innerHTML)?(he&&3===e.nodeType&&(t=e.textContent,K([D,C,A],e=>{t=ie(t,e," ")}),e.textContent!==t&&(ee(n.removed,{element:e.cloneNode()}),e.textContent=t)),St(R.afterSanitizeElements,e,null),!1):(mt(e),!0)},kt=function(e,t,n){if(Be&&("id"===t||"name"===t)&&(n in o||n in lt))return!1;if($&&!Y[t]&&ue(I,t));else if(X&&ue(j,t));else if(q.attributeCheck instanceof Function&&q.attributeCheck(t,e));else if(!F[t]||Y[t]){if(!(Et(e)&&(H.tagNameCheck instanceof RegExp&&ue(H.tagNameCheck,e)||H.tagNameCheck instanceof Function&&H.tagNameCheck(e))&&(H.attributeNameCheck instanceof RegExp&&ue(H.attributeNameCheck,t)||H.attributeNameCheck instanceof Function&&H.attributeNameCheck(t,e))||"is"===t&&H.allowCustomizedBuiltInElements&&(H.tagNameCheck instanceof RegExp&&ue(H.tagNameCheck,n)||H.tagNameCheck instanceof Function&&H.tagNameCheck(n))))return!1}else if(Ve[t]);else if(ue(B,ie(n,x,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==ae(n,"data:")||!Qe[e])if(fe&&!ue(N,ie(n,x,"")));else if(n)return!1;return!0},Et=function(e){return"annotation-xml"!==e&&re(e,L)},Pt=function(e){St(R.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||gt(e))return;const o={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:F,forceKeepAttr:void 0};let r=t.length;for(;r--;){const i=t[r],{name:a,namespaceURI:s,value:c}=i,u=ct(a),l=c;let f="value"===a?l:se(l);if(o.attrName=u,o.attrValue=f,o.keepAttr=!0,o.forceKeepAttr=void 0,St(R.uponSanitizeAttribute,e,o),f=o.attrValue,!Fe||"id"!==u&&"name"!==u||(yt(a,e),f="user-content-"+f),Re&&ue(/((--!?|])>)|<\/(style|title|textarea)/i,f)){yt(a,e);continue}if("attributename"===u&&re(f,"href")){yt(a,e);continue}if(o.forceKeepAttr)continue;if(!o.keepAttr){yt(a,e);continue}if(!pe&&ue(/\/>/i,f)){yt(a,e);continue}he&&K([D,C,A],e=>{f=ie(f,e," ")});const p=ct(e.nodeName);if(kt(p,u,f)){if(S&&"object"==typeof h&&"function"==typeof h.getAttributeType)if(s);else switch(h.getAttributeType(p,u)){case"TrustedHTML":f=S.createHTML(f);break;case"TrustedScriptURL":f=S.createScriptURL(f)}if(f!==l)try{s?e.setAttributeNS(s,a,f):e.setAttribute(a,f),gt(e)?mt(e):J(n.removed)}catch(t){yt(a,e)}}else yt(a,e)}St(R.afterSanitizeAttributes,e,null)},Tt=function e(t){let n=null;const o=bt(t);for(St(R.beforeSanitizeShadowDOM,t,null);n=o.nextNode();)St(R.uponSanitizeShadowNode,n,null),_t(n),Pt(n),n.content instanceof a&&e(n.content);St(R.afterSanitizeShadowDOM,t,null)};return n.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=null,i=null,s=null,u=null;if(et=!e,et&&(e="\x3c!--\x3e"),"string"!=typeof e&&!vt(e)){if("function"!=typeof e.toString)throw le("toString is not a function");if("string"!=typeof(e=e.toString()))throw le("dirty is not a string, aborting")}if(!n.isSupported)return e;if(Ce||pt(t),n.removed=[],"string"==typeof e&&(Ge=!1),Ge){if(e.nodeName){const t=ct(e.nodeName);if(!M[t]||z[t])throw le("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof c)o=wt("\x3c!----\x3e"),i=o.ownerDocument.importNode(e,!0),1===i.nodeType&&"BODY"===i.nodeName||"HTML"===i.nodeName?o=i:o.appendChild(i);else{if(!Ie&&!he&&!De&&-1===e.indexOf("<"))return S&&xe?S.createHTML(e):e;if(o=wt(e),!o)return Ie?null:xe?_:""}o&&Ae&&mt(o.firstChild);const l=bt(Ge?e:o);for(;s=l.nextNode();)_t(s),Pt(s),s.content instanceof a&&Tt(s.content);if(Ge)return e;if(Ie){if(Ne)for(u=P.call(o.ownerDocument);o.firstChild;)u.appendChild(o.firstChild);else u=o;return(F.shadowroot||F.shadowrootmode)&&(u=O.call(r,u,!0)),u}let f=De?o.outerHTML:o.innerHTML;return De&&M["!doctype"]&&o.ownerDocument&&o.ownerDocument.doctype&&o.ownerDocument.doctype.name&&ue(Le,o.ownerDocument.doctype.name)&&(f="<!DOCTYPE "+o.ownerDocument.doctype.name+">\n"+f),he&&K([D,C,A],e=>{f=ie(f,e," ")}),S&&xe?S.createHTML(f):f},n.setConfig=function(){pt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Ce=!0},n.clearConfig=function(){ut=null,Ce=!1},n.isValidAttribute=function(e,t,n){ut||pt({});const o=ct(e),r=ct(t);return kt(o,r,n)},n.addHook=function(e,t){"function"==typeof t&&ee(R[e],t)},n.removeHook=function(e,t){if(void 0!==t){const n=Z(R[e],t);return-1===n?void 0:te(R[e],n,1)[0]}return J(R[e])},n.removeHooks=function(e){R[e]=[]},n.removeAllHooks=function(){R={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},n}();function Ue(e){return Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ue(e)}function Ge(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function i(n,o,r,i){var c=o&&o.prototype instanceof s?o:s,u=Object.create(c.prototype);return He(u,"_invoke",function(n,o,r){var i,s,c,u=0,l=r||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,s=0,c=e,p.n=n,a}};function d(n,o){for(s=n,c=o,t=0;!f&&u&&!r&&t<l.length;t++){var r,i=l[t],d=p.p,h=i[2];n>3?(r=h===o)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=d&&((r=n<2&&d<i[1])?(s=0,p.v=o,p.n=i[1]):d<h&&(r=n<3||i[0]>o||o>h)&&(i[4]=n,i[5]=o,p.n=h,s=0))}if(r||n>1)return a;throw f=!0,o}return function(r,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),s=l,c=h;(t=s<2?e:c)||!f;){i||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,i){if(s||(r="next"),t=i[r]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),s=1);i=e}else if((t=(f=p.n<0)?c:n.call(o,p))!==a)break}catch(t){i=e,s=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,r,i),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][o]?t(t([][o]())):(He(t={},o,function(){return this}),t),f=u.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,He(e,r,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,He(f,"constructor",u),He(u,"constructor",c),c.displayName="GeneratorFunction",He(u,r,"GeneratorFunction"),He(f),He(f,r,"Generator"),He(f,o,function(){return this}),He(f,"toString",function(){return"[object Generator]"}),(Ge=function(){return{w:i,m:p}})()}function He(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}He=function(e,t,n,o){function i(t,n){He(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},He(e,t,n,o)}function ze(e,t,n,o,r,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(o,r)}function Ye(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Qe(o.key),o)}}function Qe(e){var t=function(e){if("object"!=Ue(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ue(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ue(t)?t:t+""}function qe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(qe=function(){return!!e})()}function Ve(e){return Ve=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ve(e)}function Xe(e,t){return Xe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Xe(e,t)}var $e=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t,n){return t=Ve(t),function(e,t){if(t&&("object"==Ue(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,qe()?Reflect.construct(t,n||[],Ve(e).constructor):t.apply(e,n))}(this,t,arguments)).state={buttonText:(0,o.__)("Abort Workflow","oasisworkflow"),hideButton:!0,isOpen:!1,isBusy:!1,comments:"",success:[],submitSpinner:"hide",submitButtonDisable:!1},e.handleWorkflowAbort=e.handleWorkflowAbort.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xe(e,t)}(t,e),n=t,r=[{key:"showAbortDialog",value:function(){this.setState({isOpen:!0})}},{key:"handleWorkflowAbort",value:function(e){var t=this;this.setState({isBusy:!0,submitButtonDisable:!0,submitSpinner:"show"});var n={post_id:this.props.postId,comments:this.state.comments};m()({path:"/oasis-workflow/v1/workflows/abort/",method:"POST",data:n}).then(function(e){var n=[];n.push(e.success_response),t.setState({success:n,isBusy:!1}),""!==e.redirect_link&&(window.location.href=Fe.sanitize(e.redirect_link))},function(e){return console.log(e),e})}},{key:"handleClose",value:(i=Ge().m(function e(){return Ge().w(function(e){for(;;)switch(e.n){case 0:return this.setState({isOpen:!1}),e.n=1,this.props.onSave();case 1:this.props.handleResponse();case 2:return e.a(2)}},e,this)}),a=function(){var e=this,t=arguments;return new Promise(function(n,o){var r=i.apply(e,t);function a(e){ze(r,n,o,a,s,"next",e)}function s(e){ze(r,n,o,a,s,"throw",e)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"componentDidMount",value:function(){var e=this.props,t=e.userCap,n=e.owSettings;if(t.user_can.ow_abort_workflow){var o=n.terminology_settings.oasiswf_custom_workflow_terminology,r=this.state.buttonText;o&&(r=n.terminology_settings.oasiswf_custom_workflow_terminology.abortWorkflowText),this.setState({buttonText:r,hideButton:!1,success:[],isBusy:!1})}}},{key:"render",value:function(){var e=this,t=this.state,n=t.hideButton,r=t.isOpen,i=t.success,a=t.buttonText,s=t.submitButtonDisable,c=t.submitSpinner,u=this.props.isPostInWorkflow;return n||!u?"":React.createElement(W.PanelBody,null,React.createElement(W.Button,{focus:"true",onClick:this.showAbortDialog.bind(this),isLink:!0},a),r&&React.createElement(W.Modal,{title:a,onRequestClose:function(){return e.setState({isOpen:!1})}},0!==i.length?React.createElement("div",null,React.createElement("div",{id:"owf-success-message",className:"notice notice-success is-dismissible"},i.map(function(e){return React.createElement("p",{key:e},e)})),React.createElement(W.PanelRow,null,React.createElement(W.Button,{isPrimary:!0,focus:"true",onClick:this.handleClose.bind(this)},(0,o.__)("Close","oasisworkflow")))):React.createElement("form",{className:"reusable-block-edit-panel",onSubmit:this.handleWorkflowAbort},React.createElement(W.TextareaControl,{label:(0,o.__)("Comments","oasisworkflow")+":",value:this.state.comments,onChange:function(t){return e.setState({comments:t})}}),React.createElement(W.PanelRow,null,React.createElement(W.Button,{isLink:!0,onClick:function(){return e.setState({isOpen:!1})}},(0,o.__)("Cancel","oasisworkflow")),React.createElement(W.Button,{type:"submit",isBusy:this.state.isBusy,isPrimary:!0,disabled:s,focus:"true"},a),"show"==c?React.createElement(W.Spinner,null):""))))}}],r&&Ye(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,a}(r.Component);const Ke=(0,M.compose)([(0,d.withSelect)(function(e){var t=e("core/editor"),n=t.getCurrentPostId,o=t.getEditedPostAttribute,r=e("plugin/oasis-workflow"),i=r.getOWSettings,a=r.getUserCapabilities,s=r.getPostInWorkflow;return{postId:n(),postMeta:o("meta"),owSettings:i(),userCap:a(),isPostInWorkflow:s()}}),(0,d.withDispatch)(function(e){return{onSave:e("core/editor").savePost}})])($e);var Ze=n(656);const Je=window.wp.date,et=(0,M.compose)([(0,d.withSelect)(function(e){return{dueDate:(0,e("plugin/oasis-workflow").getDueDate)()}}),(0,d.withDispatch)(function(e){return{onUpdateDate:function(t){e("plugin/oasis-workflow").setDueDate({dueDate:t})}}})])(function(e){var t=e.dueDate,n=e.onUpdateDate;return React.createElement(W.DateTimePicker,{key:"ow-date-picker",onChange:n,currentDate:t})}),tt=(0,d.withSelect)(function(e){return{date:e("plugin/oasis-workflow").getDueDate()}})(function(e){var t=e.date;return(0,Je.dateI18n)("M d, Y",t)});function nt(e){return nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nt(e)}function ot(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,rt(o.key),o)}}function rt(e){var t=function(e){if("object"!=nt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=nt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==nt(t)?t:t+""}function it(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(it=function(){return!!e})()}function at(e){return at=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},at(e)}function st(e,t){return st=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},st(e,t)}var ct=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t,n){return t=at(t),function(e,t){if(t&&("object"==nt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,it()?Reflect.construct(t,n||[],at(e).constructor):t.apply(e,n))}(this,t,arguments)).state={priorityLabel:(0,o.__)("Priority","oasisworkflow"),priorities:[],displayPriority:"",prioritySpinner:"hide"},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&st(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){var e=this,t=this.props.owSettings.terminology_settings.oasiswf_custom_workflow_terminology,n=this.props.owSettings.workflow_settings;if(t){var o=t.taskPriorityText;this.setState({priorityLabel:o})}if(n){var r=n.oasiswf_priority_setting;this.setState({displayPriority:r,prioritySpinner:"show"})}m()({path:"/oasis-workflow/v1/priorities",method:"GET"}).then(function(t){var n=t.map(function(e){return a(e,["key","value"])}),o=[];return n.map(function(e){o.push({label:e.value,value:e.key})}),e.setState({priorities:o,prioritySpinner:"hide"}),t},function(e){return console.log(e),e})}},{key:"render",value:function(){var e=this.state,t=e.priorityLabel,n=e.displayPriority;return React.createElement("div",null,React.createElement("div",{className:"owf-spinner"},"show"==this.state.prioritySpinner?React.createElement(W.Spinner,null):""),"enable_priority"===n?React.createElement(W.SelectControl,{label:t+":",value:this.props.value,options:this.state.priorities,onChange:this.props.onChange}):"")}}])&&ot(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(r.Component);const ut=(0,M.compose)([(0,d.withSelect)(function(e){return{owSettings:(0,e("plugin/oasis-workflow").getOWSettings)()}})])(ct);function lt(e){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lt(e)}function ft(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,pt(o.key),o)}}function pt(e){var t=function(e){if("object"!=lt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=lt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==lt(t)?t:t+""}function dt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(dt=function(){return!!e})()}function ht(e){return ht=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ht(e)}function mt(e,t){return mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},mt(e,t)}var yt=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t,n){return t=ht(t),function(e,t){if(t&&("object"==lt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,dt()?Reflect.construct(t,n||[],ht(e).constructor):t.apply(e,n))}(this,t,arguments)).state={workflows:[],workflowSpinner:"show"},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mt(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){var e=this,t=this.props.postId;m()({path:"/oasis-workflow/v1/workflows/postId="+t,method:"GET"}).then(function(t){var n=t.map(function(e){return a(e,["ID","name","version"])}),o=[];return n.length>1&&o.push({label:"",value:""}),n.map(function(t){1==t.version?o.push({label:t.name,value:t.ID}):o.push({label:t.name+" ("+t.version+")",value:t.ID}),1==n.length&&e.props.onChange(t.ID)}),e.setState({workflows:o,workflowSpinner:"hide"}),t},function(e){return console.log(e),e})}},{key:"render",value:function(){return React.createElement("div",null,React.createElement("div",{className:"owf-spinner"},"show"==this.state.workflowSpinner?React.createElement(W.Spinner,null):""),React.createElement(W.SelectControl,{label:(0,o.__)("Select Workflow","oasisworkflow")+":",value:this.props.value,options:this.state.workflows,onChange:this.props.onChange}))}}])&&ft(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(r.Component);const wt=(0,M.compose)([(0,d.withSelect)(function(e){return{postId:(0,e("core/editor").getCurrentPostId)()}})])(yt);function bt(e){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bt(e)}function gt(e){return function(e){if(Array.isArray(e))return vt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return vt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function St(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function i(n,o,r,i){var c=o&&o.prototype instanceof s?o:s,u=Object.create(c.prototype);return _t(u,"_invoke",function(n,o,r){var i,s,c,u=0,l=r||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,s=0,c=e,p.n=n,a}};function d(n,o){for(s=n,c=o,t=0;!f&&u&&!r&&t<l.length;t++){var r,i=l[t],d=p.p,h=i[2];n>3?(r=h===o)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=d&&((r=n<2&&d<i[1])?(s=0,p.v=o,p.n=i[1]):d<h&&(r=n<3||i[0]>o||o>h)&&(i[4]=n,i[5]=o,p.n=h,s=0))}if(r||n>1)return a;throw f=!0,o}return function(r,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),s=l,c=h;(t=s<2?e:c)||!f;){i||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,i){if(s||(r="next"),t=i[r]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),s=1);i=e}else if((t=(f=p.n<0)?c:n.call(o,p))!==a)break}catch(t){i=e,s=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,r,i),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][o]?t(t([][o]())):(_t(t={},o,function(){return this}),t),f=u.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,_t(e,r,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,_t(f,"constructor",u),_t(u,"constructor",c),c.displayName="GeneratorFunction",_t(u,r,"GeneratorFunction"),_t(f),_t(f,r,"Generator"),_t(f,o,function(){return this}),_t(f,"toString",function(){return"[object Generator]"}),(St=function(){return{w:i,m:p}})()}function _t(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}_t=function(e,t,n,o){function i(t,n){_t(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},_t(e,t,n,o)}function kt(e,t,n,o,r,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(o,r)}function Et(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function a(e){kt(i,o,r,a,s,"next",e)}function s(e){kt(i,o,r,a,s,"throw",e)}a(void 0)})}}function Pt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Ct(o.key),o)}}function Tt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Tt=function(){return!!e})()}function Ot(e){return Ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ot(e)}function Rt(e,t){return Rt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Rt(e,t)}function Dt(e,t,n){return(t=Ct(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ct(e){var t=function(e){if("object"!=bt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=bt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==bt(t)?t:t+""}var At=(0,Je.getSettings)(),It=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Dt(e=function(e,t,n){return t=Ot(t),function(e,t){if(t&&("object"==bt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Tt()?Reflect.construct(t,n||[],Ot(e).constructor):t.apply(e,n))}(this,t,arguments),"checkPostSaving",function(){var t=(0,d.select)("core/editor").isSavingPost();e.setState({isSaving:t})}),Dt(e,"processSignoffQueue",Et(St().m(function t(){var n,o,r;return St().w(function(t){for(;;)switch(t.n){case 0:if(0!==e.state.signoffQueue.length){t.n=2;break}return n=function(){return new Promise(function(t){var n=setInterval(function(){e.state.isSaving||(clearInterval(n),t())},100)})},t.n=1,n();case 1:return t.a(2);case 2:return o=e.state.signoffQueue[0],r=function(){return new Promise(function(t){var n=setInterval(function(){e.state.isSaving||(clearInterval(n),t())},100)})},t.n=3,r();case 3:return t.n=4,e.handleSubmitToWorkflowCB(o);case 4:e.setState(function(e){return{signoffQueue:e.signoffQueue.slice(1)}},function(){e.processSignoffQueue()});case 5:return t.a(2)}},t)}))),e.submitToWorkflowPanelRef=(0,r.createRef)();var n=[];return n.push({label:"",value:""}),e.state={workflowButtonText:(0,o.__)("Submit to Workflow","oasisworkflow"),assignActorLabel:(0,o.__)("Assign Actor(s)","oasisworkflow"),publishDateLabel:(0,o.__)("Publish Date","oasisworkflow"),dueDateLabel:(0,o.__)("Due Date","oasisworkflow"),displayPublishDate:"",displayDueDate:"",selectedWorkflow:"",firstSteps:n,selectedFirstStep:"",selectedPriority:"2normal",assignee:[],selectedAssignees:[],publishDate:(0,Je.dateI18n)(At.formats.datetimeAbbreviated,new Date),comments:"",assignToAll:!1,validationErrors:[],hideForm:!1,redirectingLoader:"hide",stepSpinner:"hide",assigneeSpinner:"hide",submitSpinner:"hide",isSaving:!1,signoffQueue:[],submitButtonDisable:!1},e.unsubscribe=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rt(e,t)}(t,e),n=t,i=[{key:"componentDidMount",value:function(){var e=this,t=this.props.owSettings.terminology_settings.oasiswf_custom_workflow_terminology,n=this.props.owSettings.workflow_settings;if(t){var o=t.submitToWorkflowText,r=t.assignActorsText,i=t.publishDateText,a=t.dueDateText;this.setState({workflowButtonText:o,assignActorLabel:r,publishDateLabel:i,dueDateLabel:a})}if(n){var s=n.oasiswf_publish_date_setting,c=n.oasiswf_default_due_days,u=new Date;""!==c&&u.setDate(u.getDate()+parseInt(c)),this.props.setDueDate({dueDate:u}),this.setState({displayPublishDate:s,displayDueDate:c})}this.unsubscribe=(0,d.subscribe)(function(){e.checkPostSaving()})}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe()}},{key:"getFirstStep",value:function(e){var t=this,n=this.props.postId;this.setState({selectedWorkflow:e,validationErrors:[],stepSpinner:"show",assigneeSpinner:"show"}),m()({path:"/oasis-workflow/v1/workflows/submit/firstStep/workflowId="+e+"/postId="+n,method:"GET"}).then(function(e){var n,r=e.step_id,i=e.step_label,a=[],s=1===e.assign_to_all,c=[];a.push({label:i,value:r});var u=new Date;e.due_days&&u.setDate(u.getDate()+parseInt(e.due_days)),t.props.setDueDate({dueDate:u});var l=e.users;if(0===l.length)return c.push((0,o.__)("No users found to assign the task.","oasisworkflow")),t.setState({firstSteps:a,selectedFirstStep:r,validationErrors:c,assignee:[]}),void t.submitToWorkflowPanelRef.current.scrollIntoView();var p=f({assignees:l,assignToAll:s});return n=p.availableAssignees,t.setState({firstSteps:a,selectedFirstStep:r,assignee:n,selectedAssignees:p.selectedAssignees,assignToAll:s,stepSpinner:"hide",assigneeSpinner:"hide"}),e},function(e){return console.log(e),e})}},{key:"handleOnPriorityChange",value:function(e){this.setState({selectedPriority:e})}},{key:"validateSubmitToWorkflow",value:(u=Et(St().m(function e(t){var n,r,i,a,s;return St().w(function(e){for(;;)switch(e.n){case 0:if(n=[],r=new Date,r=moment(r).format("YYYY-MM-DD"),i=moment(t.due_date).format("YYYY-MM-DD"),a=this.state.selectedWorkflow,s=this.state.selectedFirstStep,""===a&&n.push((0,o.__)("Please select a workflow.","oasisworkflow")),""===s&&n.push((0,o.__)("Please select a step.","oasisworkflow")),""===t.due_date&&n.push((0,o.__)("Please enter a due date.","oasisworkflow")),""!==t.due_date&&1==moment(r).isAfter(i)&&n.push((0,o.__)("Due date must be greater than the current date.","oasisworkflow")),0!==t.assignees.length||this.state.assignToAll||n.push((0,o.__)("No assigned actor(s).","oasisworkflow")),void 0===window.acf){e.n=2;break}return e.n=1,window.workflowSubmitWithACF();case 1:"invalid"===e.v&&n.push((0,o.__)("Please enter ACF required fields.","oasisworkflow"));case 2:return e.a(2,n)}},e,this)})),function(_x){return u.apply(this,arguments)})},{key:"handleSubmitToWorkflow",value:(c=Et(St().m(function e(t){var n=this;return St().w(function(e){for(;;)switch(e.n){case 0:t.preventDefault(),this.setState({validationErrors:[]}),this.setState(function(e){return{signoffQueue:[].concat(gt(e.signoffQueue),[t])}},function(){n.processSignoffQueue()});case 1:return e.a(2)}},e,this)})),function(e){return c.apply(this,arguments)})},{key:"handleSubmitToWorkflowCB",value:(s=Et(St().m(function e(t){var n,o,r,i=this;return St().w(function(e){for(;;)switch(e.p=e.n){case 0:return this.setState({submitSpinner:"show",submitButtonDisable:!0}),n={post_id:this.props.postId,step_id:this.state.selectedFirstStep,priority:this.state.selectedPriority,assignees:this.state.selectedAssignees,due_date:this.props.dueDate,publish_date:this.props.publishDate,comments:this.state.comments},e.p=1,e.n=2,this.props.onSave();case 2:e.n=4;break;case 3:e.p=3,"rest_forbidden_context"===(r=e.v).code?console.error("Permission error:",r.message):console.error("An unexpected error occurred:",r);case 4:return e.n=5,this.validateSubmitToWorkflow(n);case 5:if(!((o=e.v).length>0)){e.n=6;break}return this.setState({validationErrors:o,submitSpinner:"hide",submitButtonDisable:!1}),this.submitToWorkflowPanelRef.current.scrollIntoView(),e.a(2);case 6:this.setState({validationErrors:[]}),this.setState({isSaving:!0},Et(St().m(function e(){return St().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,i.processSignoffQueue();case 1:if(i.state.isSaving){e.n=2;break}return e.n=2,i.invokeSubmitToWorkflowAPI(n);case 2:return e.a(2)}},e)})));case 7:return e.a(2)}},e,this,[[1,3]])})),function(e){return s.apply(this,arguments)})},{key:"invokeSubmitToWorkflowAPI",value:(a=Et(St().m(function e(t){var n=this;return St().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,new Promise(function(e){return setTimeout(e,100)});case 1:return e.n=2,m()({path:"/oasis-workflow/v1/workflows/submit/",method:"POST",data:t}).then(function(e){n.setState({hideForm:!0,redirectingLoader:"show"}),""!==e.redirect_link?window.location.href=Fe.sanitize(e.redirect_link):n.props.handleResponse(e)},function(e){return console.log(e),e});case 2:return e.a(2)}},e)})),function(e){return a.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.props,n=t.isSaving,i=t.isCurrentPostPublished,a=t.isCurrentPostScheduled,s=(t.postStatus,t.isPostInWorkflow),c=t.postMeta,u=this.state,l=u.validationErrors,f=u.hideForm,p=u.workflowButtonText,d=u.assignActorLabel,h=u.publishDateLabel,m=u.dueDateLabel,y=u.displayPublishDate,w=u.displayDueDate,b=u.redirectingLoader,g=u.stepSpinner,v=u.assigneeSpinner,S=u.submitSpinner,_=u.submitButtonDisable;return f&&"show"===b?React.createElement("div",null,React.createElement(W.PanelBody,null,(0,o.__)("redirecting...","oasisworkflow"))):c&&"1"==c._oasis_is_in_workflow||s||f||i||a?"":React.createElement(W.PanelBody,{ref:this.submitToWorkflowPanelRef,initialOpen:!0,title:p},React.createElement("form",{className:"reusable-block-edit-panel"},0!==l.length?React.createElement("div",{id:"owf-error-message",className:"notice notice-error is-dismissible"},l.map(function(e){return React.createElement("p",{key:e},e)})):"",React.createElement(wt,{value:this.state.selectedWorkflow,onChange:this.getFirstStep.bind(this)}),React.createElement("div",{className:"owf-spinner"},"show"==g?React.createElement(W.Spinner,null):""),React.createElement(W.SelectControl,{label:(0,o.__)("Step","oasisworkflow")+":",value:this.state.selectedFirstStep,options:this.state.firstSteps,onChange:function(t){return e.setState({selectedFirstStep:t})}}),React.createElement(ut,{value:this.state.selectedPriority,onChange:this.handleOnPriorityChange.bind(this)}),React.createElement("div",{className:"owf-spinner"},"show"==v&&0==this.state.assignToAll?React.createElement(W.Spinner,null):""),this.state.assignToAll?"":React.createElement(W.SelectControl,{multiple:!0,className:"ow-multi-select",label:d+":",value:this.state.selectedAssignees,options:this.state.assignee,onChange:function(t){return e.setState({selectedAssignees:t})}}),""==y?React.createElement(W.PanelRow,{className:"edit-post-post-schedule"},React.createElement("label",null,h+":"," "),React.createElement(W.Dropdown,{popoverProps:{placement:"bottom-end"},contentClassName:"edit-post-post-schedule__dialog",renderToggle:function(e){var t=e.onToggle,n=e.isOpen;return React.createElement(r.Fragment,null,React.createElement(W.Button,{type:"button",onClick:t,"aria-expanded":n,"aria-live":"polite",isLink:!0},React.createElement(Ze.PostScheduleLabel,null)))},renderContent:function(){return React.createElement(Ze.PostSchedule,null)}})):"",""!==w?React.createElement(W.PanelRow,{className:"edit-post-post-schedule"},React.createElement("label",null,m+":"," "),React.createElement(W.Dropdown,{popoverProps:{placement:"bottom-end"},contentClassName:"edit-post-post-schedule__dialog owduedatepicker-dropdown",renderToggle:function(e){var t=e.onToggle,n=e.isOpen;return React.createElement(r.Fragment,null,React.createElement(W.Button,{type:"button",onClick:t,"aria-expanded":n,"aria-live":"polite",isLink:!0},React.createElement(tt,null)))},renderContent:function(){return React.createElement(et,null)}})):"",React.createElement(W.PanelRow,null,React.createElement(W.TextareaControl,{label:(0,o.__)("Comments","oasisworkflow")+":",value:this.state.comments,onChange:function(t){return e.setState({comments:t})}})),React.createElement(W.PanelRow,null,React.createElement(W.Button,{isPrimary:!0,isBusy:n,focus:"true",disabled:_,onClick:this.handleSubmitToWorkflow.bind(this)},p),React.createElement("div",{className:"owf-spinner"},"show"==S?React.createElement(W.Spinner,null):""))))}}],i&&Pt(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,i,a,s,c,u}(r.Component);const jt=(0,M.compose)([(0,d.withSelect)(function(e){var t=e("core/editor"),n=t.getCurrentPostId,o=t.getEditedPostAttribute,r=t.isCurrentPostPublished,i=t.isCurrentPostScheduled,a=t.getCurrentPost,s=e("plugin/oasis-workflow"),c=s.getDueDate,u=s.getOWSettings,l=s.getPostInWorkflow,f=a(),p=f.status;return f.type,{postId:n(),postMeta:o("meta"),isCurrentPostPublished:r(),isCurrentPostScheduled:i(),publishDate:o("date"),dueDate:c(),owSettings:u(),postStatus:p,isPostInWorkflow:l()}}),(0,d.withDispatch)(function(e){return{onSave:e("core/editor").savePost,autosave:e("core/editor").autosave,setDueDate:e("plugin/oasis-workflow").setDueDate}})])(It);function Nt(e){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nt(e)}function xt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Lt(o.key),o)}}function Lt(e){var t=function(e){if("object"!=Nt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Nt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Nt(t)?t:t+""}function Bt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Bt=function(){return!!e})()}function Mt(e){return Mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Mt(e)}function Wt(e,t){return Wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Wt(e,t)}var Ft=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){return t=Mt(t),function(e,t){if(t&&("object"==Nt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Bt()?Reflect.construct(t,n||[],Mt(e).constructor):t.apply(e,n))}(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wt(e,t)}(t,e),n=t,(r=[{key:"handleRedirectToListPage",value:function(){"post"===this.props.postType?window.location.href="edit.php":window.location.href="edit.php?post_type="+this.props.postType}},{key:"handleRedirectToInboxPage",value:function(){window.location.href="admin.php?page=oasiswf-inbox"}},{key:"render",value:function(){var e;return s("string"==typeof(e=this.props.response)?e.trim():e)?"":React.createElement("div",null,React.createElement(W.PanelBody,null,React.createElement("div",{id:"owf-success-message",className:"notice notice-success is-dismissible"},this.props.response)),React.createElement(W.PanelBody,null,React.createElement(W.PanelRow,null,React.createElement("p",{className:"post-publish-panel__postpublish-subheader"},React.createElement("strong",null,(0,o.__)("Whats next?","oasisworkflow")))),React.createElement(W.PanelRow,null,React.createElement(W.Button,{focus:"true",onClick:this.handleRedirectToListPage.bind(this),isLink:!0},(0,o.__)("Take me to List page","oasisworkflow"))),React.createElement(W.PanelRow,null,React.createElement(W.Button,{focus:"true",onClick:this.handleRedirectToInboxPage.bind(this),isLink:!0},(0,o.__)("Take me to Workflow Inbox","oasisworkflow")))))}}])&&xt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(r.Component);const Ut=(0,M.compose)([(0,d.withSelect)(function(e){return{postType:(0,e("core/editor").getCurrentPostType)()}})])(Ft);function Gt(e){return Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gt(e)}function Ht(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,zt(o.key),o)}}function zt(e){var t=function(e){if("object"!=Gt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Gt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Gt(t)?t:t+""}function Yt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Yt=function(){return!!e})()}function Qt(e){return Qt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Qt(e)}function qt(e,t){return qt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},qt(e,t)}var Vt=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t,n){return t=Qt(t),function(e,t){if(t&&("object"==Gt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Yt()?Reflect.construct(t,n||[],Qt(e).constructor):t.apply(e,n))}(this,t,arguments)).state={isBusy:!1,success:[],responseErrors:[],hideClaim:!1,submitSpinner:"hide",submitButtonDisable:!1},e.handleClaim=e.handleClaim.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qt(e,t)}(t,e),n=t,(r=[{key:"handleClaim",value:function(e){var t=this;this.setState({isBusy:!0,submitSpinner:"show",submitButtonDisable:!0});var n=this.props.postId,o={post_id:n,history_id:this.props.actionHistoryId};m()({path:"/oasis-workflow/v1/workflows/claim/",method:"POST",data:o}).then(function(e){var o=[];if("true"===e.isError)return o.push(e.errorMessage),void t.setState({responseErrors:o,hideClaim:!0});if("false"===e.isError){var r=e.new_history_id,i=e.url;window.location.href=i+"post.php?post="+n+"&action=edit&oasiswf="+r}},function(e){return console.log(e),e})}},{key:"componentDidMount",value:function(){this.setState({isBusy:!1})}},{key:"render",value:function(){var e=this.state,t=e.responseErrors,n=(e.hideClaim,e.submitSpinner),r=e.submitButtonDisable;return React.createElement("div",null,0!==t.length?React.createElement("div",{id:"owf-error-message",className:"notice notice-error is-dismissible"},t.map(function(e){return React.createElement("p",{key:e},e)})):"",this.props.isHidden?"":React.createElement(W.PanelBody,null,React.createElement(W.Button,{focus:"true",isPrimary:!0,disabled:r,onClick:this.handleClaim},(0,o.__)("Claim","oasisworkflow")),"show"==n?React.createElement(W.Spinner,null):""))}}])&&Ht(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(r.Component);const Xt=(0,d.withSelect)(function(e){return{postId:(0,e("core/editor").getCurrentPostId)()}})(Vt);function $t(e){return $t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$t(e)}function Kt(e){return function(e){if(Array.isArray(e))return Zt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Zt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function Jt(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function i(n,o,r,i){var c=o&&o.prototype instanceof s?o:s,u=Object.create(c.prototype);return en(u,"_invoke",function(n,o,r){var i,s,c,u=0,l=r||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,s=0,c=e,p.n=n,a}};function d(n,o){for(s=n,c=o,t=0;!f&&u&&!r&&t<l.length;t++){var r,i=l[t],d=p.p,h=i[2];n>3?(r=h===o)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=d&&((r=n<2&&d<i[1])?(s=0,p.v=o,p.n=i[1]):d<h&&(r=n<3||i[0]>o||o>h)&&(i[4]=n,i[5]=o,p.n=h,s=0))}if(r||n>1)return a;throw f=!0,o}return function(r,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),s=l,c=h;(t=s<2?e:c)||!f;){i||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,i){if(s||(r="next"),t=i[r]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),s=1);i=e}else if((t=(f=p.n<0)?c:n.call(o,p))!==a)break}catch(t){i=e,s=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,r,i),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][o]?t(t([][o]())):(en(t={},o,function(){return this}),t),f=u.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,en(e,r,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,en(f,"constructor",u),en(u,"constructor",c),c.displayName="GeneratorFunction",en(u,r,"GeneratorFunction"),en(f),en(f,r,"Generator"),en(f,o,function(){return this}),en(f,"toString",function(){return"[object Generator]"}),(Jt=function(){return{w:i,m:p}})()}function en(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}en=function(e,t,n,o){function i(t,n){en(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},en(e,t,n,o)}function tn(e,t,n,o,r,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(o,r)}function nn(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function a(e){tn(i,o,r,a,s,"next",e)}function s(e){tn(i,o,r,a,s,"throw",e)}a(void 0)})}}function on(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,un(o.key),o)}}function rn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(rn=function(){return!!e})()}function an(e){return an=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},an(e)}function sn(e,t){return sn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},sn(e,t)}function cn(e,t,n){return(t=un(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function un(e){var t=function(e){if("object"!=$t(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=$t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==$t(t)?t:t+""}var ln=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),cn(e=function(e,t,n){return t=an(t),function(e,t){if(t&&("object"==$t(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,rn()?Reflect.construct(t,n||[],an(e).constructor):t.apply(e,n))}(this,t,arguments),"checkPostSaving",function(){var t=(0,d.select)("core/editor").isSavingPost();e.setState({isSaving:t})}),cn(e,"processSignoffQueue",nn(Jt().m(function t(){var n,o,r;return Jt().w(function(t){for(;;)switch(t.n){case 0:if(0!==e.state.signoffQueue.length){t.n=2;break}return n=function(){return new Promise(function(t){var n=setInterval(function(){e.state.isSaving||(clearInterval(n),t())},100)})},t.n=1,n();case 1:return t.a(2);case 2:return o=e.state.signoffQueue[0],r=function(){return new Promise(function(t){var n=setInterval(function(){e.state.isSaving||(clearInterval(n),t())},100)})},t.n=3,r();case 3:return t.n=4,e.handleWorkflowCompleteCB(o);case 4:e.setState(function(e){return{signoffQueue:e.signoffQueue.slice(1)}},function(){e.processSignoffQueue()});case 5:return t.a(2)}},t)}))),e.state={signoffButtonText:(0,o.__)("Sign Off","oasisworkflow"),comments:"",actionHistoryId:c(),taskUser:u(),isImmediatelyChecked:!1,originalPublishDate:e.props.publishDate,redirectingLoader:"hide",submitSpinner:"hide",isSaving:!1,signoffQueue:[],submitButtonDisable:!1},e.unsubscribe=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sn(e,t)}(t,e),n=t,i=[{key:"componentDidMount",value:function(){var e=this,t=this.props.owSettings.terminology_settings.oasiswf_custom_workflow_terminology;if(t){var n=t.signOffText;this.setState({signoffButtonText:n})}this.unsubscribe=(0,d.subscribe)(function(){e.checkPostSaving()})}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe()}},{key:"validateSignoff",value:(f=nn(Jt().m(function e(t){var n;return Jt().w(function(e){for(;;)switch(e.n){case 0:if(n=[],void 0===window.acf){e.n=2;break}return e.n=1,window.workflowSubmitWithACF();case 1:"invalid"===e.v&&n.push((0,o.__)("Please enter ACF required fields.","oasisworkflow"));case 2:return e.a(2,n)}},e)})),function(_x){return f.apply(this,arguments)})},{key:"handleWorkflowComplete",value:(l=nn(Jt().m(function e(t){var n=this;return Jt().w(function(e){for(;;)switch(e.n){case 0:t.preventDefault(),this.setState({validationErrors:[]}),this.setState(function(e){return{signoffQueue:[].concat(Kt(e.signoffQueue),[t])}},function(){n.processSignoffQueue()});case 1:return e.a(2)}},e,this)})),function(e){return l.apply(this,arguments)})},{key:"handleWorkflowCompleteCB",value:(s=nn(Jt().m(function e(t){var n,o,r=this;return Jt().w(function(e){for(;;)switch(e.p=e.n){case 0:return this.setState({submitSpinner:"show",submitButtonDisable:!0}),n={post_id:this.props.postId,history_id:this.state.actionHistoryId,immediately:this.state.isImmediatelyChecked,task_user:this.state.taskUser,publish_datetime:this.props.publishDate},e.p=1,e.n=2,this.props.onSave();case 2:e.n=4;break;case 3:e.p=3,"rest_forbidden_context"===(o=e.v).code?console.error("Permission error:",o.message):console.error("An unexpected error occurred:",o);case 4:return e.n=5,this.validateSignoff(n);case 5:if(!(e.v.length>0)){e.n=6;break}return this.setState({submitSpinner:"hide",submitButtonDisable:!1}),e.a(2);case 6:this.setState({isSaving:!0},nn(Jt().m(function e(){return Jt().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r.processSignoffQueue();case 1:if(r.state.isSaving){e.n=2;break}return e.n=2,r.invokeSignoffAPI(n);case 2:return e.a(2)}},e)})));case 7:return e.a(2)}},e,this,[[1,3]])})),function(e){return s.apply(this,arguments)})},{key:"redirectTrigger",value:function(e){this.setState({redirectingLoader:"show"}),window.location.href=Fe.sanitize(e)}},{key:"refreshTrigger",value:function(e){this.props.handleResponse(e),this.props.pageRefresh()}},{key:"invokeSignoffAPI",value:function(e){var t=this;m()({path:"/oasis-workflow/v1/workflows/signoff/workflowComplete/",method:"POST",data:e}).then(function(e){var n=new CustomEvent("ow_workflow_completed",{detail:e});if(document.dispatchEvent(n),""!==e.redirect_link){var o=function(){var n=nn(Jt().m(function n(){return Jt().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,t.props.editPost({status:e.new_post_status});case 1:return n.n=2,t.props.onSave();case 2:t.redirectTrigger(e.redirect_link);case 3:return n.a(2)}},n)}));return function(){return n.apply(this,arguments)}}();o()}else{var r=function(){var n=nn(Jt().m(function n(){return Jt().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,t.props.editPost({status:e.new_post_status});case 1:return n.n=2,t.props.onSave();case 2:t.refreshTrigger(e);case 3:return n.a(2)}},n)}));return function(){return n.apply(this,arguments)}}();r()}},function(e){return console.log(e),e})}},{key:"handleWorkflowCancel",value:function(e){var t=this;this.setState({submitSpinner:"show",submitButtonDisable:!0});var n={post_id:this.props.postId,history_id:this.state.actionHistoryId,comments:this.state.comments,task_user:this.state.taskUser};m()({path:"/oasis-workflow/v1/workflows/signoff/workflowCancel/",method:"POST",data:n}).then(function(e){t.props.handleResponse(e)},function(e){return console.log(e),e})}},{key:"onImmediatelyChange",value:(a=nn(Jt().m(function e(t){var n,o;return Jt().w(function(e){for(;;)switch(e.n){case 0:return n=new Date,o="",t?(this.setState({isImmediatelyChecked:!0}),o=n):(this.setState({isImmediatelyChecked:!1}),o=this.state.originalPublishDate),this.props.editPost({date:o}),e.n=1,this.props.onSave();case 1:return e.a(2)}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.props,n=t.isSaving,i=(t.postMeta,this.state),a=i.isImmediatelyChecked,s=i.signoffButtonText,c=i.redirectingLoader,u=i.submitSpinner,l=i.submitButtonDisable;return"show"===c?React.createElement("div",null,React.createElement(W.PanelBody,null,(0,o.__)("redirecting...","oasisworkflow"))):React.createElement("div",null,"success"===this.props.stepDecision?React.createElement("div",null,React.createElement(W.PanelRow,null,React.createElement("div",{id:"owf-success-message",className:"notice notice-warning is-dismissible"},React.createElement("p",null,(0,o.__)("This is the last step in the workflow. Are you sure to complete the workflow?","oasisworkflow")))),React.createElement(W.PanelRow,{className:"edit-post-post-schedule"},React.createElement("label",null,(0,o.__)("Publish","oasisworkflow")+":"," "),React.createElement(W.Dropdown,{popoverProps:{placement:"bottom-end"},contentClassName:"edit-post-post-schedule__dialog",renderToggle:function(e){var t=e.onToggle,n=e.isOpen;return React.createElement(r.Fragment,null,React.createElement(W.Button,{type:"button",onClick:t,"aria-expanded":n,"aria-live":"polite",isLink:!0},React.createElement(Ze.PostScheduleLabel,null)))},renderContent:function(){return React.createElement(Ze.PostSchedule,null)}})),React.createElement(W.PanelRow,null,React.createElement(W.CheckboxControl,{label:(0,o.__)("Publish Immediately?","oasisworkflow"),checked:a,onChange:this.onImmediatelyChange.bind(this)})),React.createElement(W.PanelRow,null,React.createElement(W.Button,{isPrimary:!0,isBusy:n,focus:"true",disabled:l,onClick:this.handleWorkflowComplete.bind(this)},s),React.createElement("div",{className:"owf-spinner"},"show"==u?React.createElement(W.Spinner,null):""))):React.createElement("div",null,React.createElement(W.PanelRow,null,React.createElement("div",{id:"owf-success-message",className:"notice notice-error is-dismissible"},React.createElement("p",null,(0,o.__)("There are no further steps defined in the workflow. Do you want to cancel the post/page from the workflow?","oasisworkflow")))),React.createElement(W.PanelRow,null,React.createElement(W.TextareaControl,{label:(0,o.__)("Comments","oasisworkflow")+":",value:this.state.comments,onChange:function(t){return e.setState({comments:t})}})),React.createElement(W.PanelRow,null,React.createElement(W.Button,{isPrimary:!0,isBusy:n,focus:"true",disabled:l,onClick:this.handleWorkflowCancel.bind(this)},s),React.createElement("div",{className:"owf-spinner"},"show"==u?React.createElement(W.Spinner,null):""))))}}],i&&on(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,i,a,s,l,f}(r.Component);const fn=(0,M.compose)([(0,d.withSelect)(function(e){var t=e("core/editor"),n=t.getCurrentPostId,o=t.getEditedPostAttribute,r=e("plugin/oasis-workflow").getOWSettings;return{postId:n(),publishDate:o("date"),postMeta:o("meta"),owSettings:r()}}),(0,d.withDispatch)(function(e){return{onSave:e("core/editor").savePost,editPost:e("core/editor").editPost,autosave:e("core/editor").autosave,pageRefresh:e("core/editor").refreshPost}})])(ln);function pn(e){return pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pn(e)}function dn(e){return function(e){if(Array.isArray(e))return hn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return hn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hn(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function mn(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function i(n,o,r,i){var c=o&&o.prototype instanceof s?o:s,u=Object.create(c.prototype);return yn(u,"_invoke",function(n,o,r){var i,s,c,u=0,l=r||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,s=0,c=e,p.n=n,a}};function d(n,o){for(s=n,c=o,t=0;!f&&u&&!r&&t<l.length;t++){var r,i=l[t],d=p.p,h=i[2];n>3?(r=h===o)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=d&&((r=n<2&&d<i[1])?(s=0,p.v=o,p.n=i[1]):d<h&&(r=n<3||i[0]>o||o>h)&&(i[4]=n,i[5]=o,p.n=h,s=0))}if(r||n>1)return a;throw f=!0,o}return function(r,l,h){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),s=l,c=h;(t=s<2?e:c)||!f;){i||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,i){if(s||(r="next"),t=i[r]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),s=1);i=e}else if((t=(f=p.n<0)?c:n.call(o,p))!==a)break}catch(t){i=e,s=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,r,i),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][o]?t(t([][o]())):(yn(t={},o,function(){return this}),t),f=u.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,yn(e,r,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,yn(f,"constructor",u),yn(u,"constructor",c),c.displayName="GeneratorFunction",yn(u,r,"GeneratorFunction"),yn(f),yn(f,r,"Generator"),yn(f,o,function(){return this}),yn(f,"toString",function(){return"[object Generator]"}),(mn=function(){return{w:i,m:p}})()}function yn(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}yn=function(e,t,n,o){function i(t,n){yn(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},yn(e,t,n,o)}function wn(e,t,n,o,r,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(o,r)}function bn(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function a(e){wn(i,o,r,a,s,"next",e)}function s(e){wn(i,o,r,a,s,"throw",e)}a(void 0)})}}function gn(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Pn(o.key),o)}}function vn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(vn=function(){return!!e})()}function Sn(e){return Sn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Sn(e)}function kn(e,t){return kn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},kn(e,t)}function En(e,t,n){return(t=Pn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pn(e){var t=function(e){if("object"!=pn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=pn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==pn(t)?t:t+""}var Tn=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),En(e=function(e,t,n){return t=Sn(t),function(e,t){if(t&&("object"==pn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,vn()?Reflect.construct(t,n||[],Sn(e).constructor):t.apply(e,n))}(this,t,arguments),"checkPostSaving",function(){var t=(0,d.select)("core/editor").isSavingPost();e.setState({isSaving:t})}),En(e,"processSignoffQueue",bn(mn().m(function t(){var n,o,r;return mn().w(function(t){for(;;)switch(t.n){case 0:if(0!==e.state.signoffQueue.length){t.n=2;break}return n=function(){return new Promise(function(t){var n=setInterval(function(){e.state.isSaving||(clearInterval(n),t())},100)})},t.n=1,n();case 1:return t.a(2);case 2:return o=e.state.signoffQueue[0],r=function(){return new Promise(function(t){var n=setInterval(function(){e.state.isSaving||(clearInterval(n),t())},100)})},t.n=3,r();case 3:return t.n=4,e.handleSignoffCB(o);case 4:e.setState(function(e){return{signoffQueue:e.signoffQueue.slice(1)}},function(){e.processSignoffQueue()});case 5:return t.a(2)}},t)}))),e.signoffPanelRef=(0,r.createRef)(),e.state={signoffButtonText:(0,o.__)("Sign Off","oasisworkflow"),assignActorLabel:(0,o.__)("Assign Actor(s)","oasisworkflow"),dueDateLabel:(0,o.__)("Due Date","oasisworkflow"),displayDueDate:"",actions:[],selectedAction:"",signoffSteps:[{label:"",value:""}],selectedStep:"",selectedPriority:"2normal",assignee:[],selectedAssignees:[],assignToAll:!1,actionHistoryId:c(),taskUser:u(),comments:"",isLastStep:!1,lastStepDecision:"success",validationErrors:[],redirectingLoader:"hide",stepSpinner:"hide",assigneeSpinner:"hide",submitSpinner:"hide",isApiInProgress:!1,isSaving:!1,signoffQueue:[],isMakeAjaxRequest:!1,submitButtonDisable:!1},e.unsubscribe=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kn(e,t)}(t,e),n=t,i=[{key:"componentDidMount",value:function(){var e=this,t=this.props.owSettings.terminology_settings.oasiswf_custom_workflow_terminology,n=this.props.owSettings.workflow_settings;if(t){var o=t.signOffText,r=t.assignActorsText,i=t.dueDateText;this.setState({signoffButtonText:o,assignActorLabel:r,dueDateLabel:i})}if(n){var a=n.oasiswf_default_due_days,s=new Date;""!==a&&s.setDate(s.getDate()+parseInt(a)),this.props.setDueDate({dueDate:s}),this.setState({displayDueDate:a})}m()({path:"/oasis-workflow/v1/workflows/signoff/stepActions/actionHistoryId="+this.state.actionHistoryId,method:"GET"}).then(function(t){var n=t.process;e.setState({actions:l(n)})},function(e){return console.log(e),e}),this.unsubscribe=(0,d.subscribe)(function(){e.checkPostSaving()})}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe()}},{key:"getSignoffSteps",value:function(e){var t=this,n=this.props.postId,r="success";this.setState({selectedAction:e,stepSpinner:"show"}),"complete"===e&&(r="success"),"unable"===e&&(r="failure"),m()({path:"/oasis-workflow/v1/workflows/signoff/nextSteps/actionHistoryId="+this.state.actionHistoryId+"/decision="+r+"/postId="+n,method:"GET"}).then(function(e){if(""===e.steps)t.setState({isLastStep:!0,lastStepDecision:r,stepSpinner:"hide"});else{t.setState({isLastStep:!1,lastStepDecision:"success"});var n=e.steps.map(function(e){return a(e,["step_id","step_name"])}),i=[];1!==n.length&&i.push({label:(0,o.__)("Select Step","oasisworkflow"),value:""}),n.map(function(e){i.push({label:e.step_name,value:e.step_id})}),t.setState({signoffSteps:i,stepSpinner:"hide"}),1==n.length&&(t.getSelectedStepDetails(i[0].value),t.setState({selectedStep:i[0].value}))}return e},function(e){return console.log(e),e})}},{key:"getSelectedStepDetails",value:function(e){var t=this,n=this.props.postId;this.setState({selectedStep:e,assigneeSpinner:"show"}),m()({path:"/oasis-workflow/v1/workflows/signoff/stepDetails/actionHistoryId="+this.state.actionHistoryId+"/stepId="+e+"/postId="+n,method:"GET"}).then(function(e){var n,r=[],i=1===e.assign_to_all,a=e.users;if(t.props.setDueDate({dueDate:e.due_date}),0===a.length)return r.push((0,o.__)("No users found to assign the task.","oasisworkflow")),t.setState({validationErrors:r,assignee:[]}),void t.signoffPanelRef.current.scrollIntoView();var s=f({assignees:a,assignToAll:i});return n=s.availableAssignees,t.setState({assignee:n,assignToAll:i,selectedAssignees:s.selectedAssignees,assigneeSpinner:"hide"}),e},function(e){return console.log(e),e})}},{key:"handleOnPriorityChange",value:function(e){this.setState({selectedPriority:e})}},{key:"validateSignoff",value:(y=bn(mn().m(function e(t){var n,r,i;return mn().w(function(e){for(;;)switch(e.n){case 0:if(n=[],r=new Date,r=moment(r).format("YYYY-MM-DD"),i=moment(t.due_date).format("YYYY-MM-DD"),""===t.step_id&&n.push((0,o.__)("Please select a step.","oasisworkflow")),""===t.due_date&&n.push((0,o.__)("Please enter a due date.","oasisworkflow")),""!==t.due_date&&1==moment(r).isAfter(i)&&n.push((0,o.__)("Due date must be greater than the current date.","oasisworkflow")),0!==t.assignees.length||this.state.assignToAll||n.push((0,o.__)("No assigned actor(s).","oasisworkflow")),void 0===window.acf){e.n=2;break}return e.n=1,window.workflowSubmitWithACF();case 1:"invalid"===e.v&&n.push((0,o.__)("Please enter ACF required fields.","oasisworkflow"));case 2:return e.a(2,n)}},e,this)})),function(_x){return y.apply(this,arguments)})},{key:"handleSignoff",value:(h=bn(mn().m(function e(t){var n=this;return mn().w(function(e){for(;;)switch(e.n){case 0:t.preventDefault(),this.setState({validationErrors:[]}),this.setState(function(e){return{signoffQueue:[].concat(dn(e.signoffQueue),[t])}},function(){n.processSignoffQueue()});case 1:return e.a(2)}},e,this)})),function(e){return h.apply(this,arguments)})},{key:"handleSignoffCB",value:(p=bn(mn().m(function e(t){var n,o,r,i=this;return mn().w(function(e){for(;;)switch(e.p=e.n){case 0:return this.setState({submitSpinner:"show",submitButtonDisable:!0}),n={post_id:this.props.postId,step_id:this.state.selectedStep,decision:this.state.selectedAction,priority:this.state.selectedPriority,assignees:this.state.selectedAssignees,due_date:this.props.dueDate,comments:this.state.comments,history_id:this.state.actionHistoryId,hideSignOff:!1,task_user:this.state.taskUser},e.p=1,e.n=2,this.props.onSave();case 2:e.n=4;break;case 3:e.p=3,"rest_forbidden_context"===(r=e.v).code?console.error("Permission error:",r.message):console.error("An unexpected error occurred:",r);case 4:return e.n=5,this.validateSignoff(n);case 5:if(!((o=e.v).length>0)){e.n=6;break}return this.setState({validationErrors:o,submitSpinner:"hide",submitButtonDisable:!1}),this.signoffPanelRef.current.scrollIntoView(),e.a(2);case 6:this.setState({validationErrors:[]}),this.setState({isSaving:!0},bn(mn().m(function e(){return mn().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,i.processSignoffQueue();case 1:if(i.state.isSaving){e.n=2;break}return e.n=2,i.invokeSignoffAPI(n);case 2:return e.a(2)}},e)})));case 7:return e.a(2)}},e,this,[[1,3]])})),function(e){return p.apply(this,arguments)})},{key:"invokeSignoffAPI",value:(s=bn(mn().m(function e(t){var n=this;return mn().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,new Promise(function(e){return setTimeout(e,100)});case 1:if(!this.state.isMakeAjaxRequest){e.n=2;break}return console.log("invokeSignoffAPI request already running."),e.a(2);case 2:return e.n=3,m()({path:"/oasis-workflow/v1/workflows/signoff/",method:"POST",data:t}).then(function(e){e.new_action_history_id!=n.state.actionHistoryId&&n.setState({hideSignOff:!0,redirectingLoader:"show"}),""!==e.redirect_link?window.location.href=Fe.sanitize(e.redirect_link):n.props.handleResponse(e),n.setState({isApiInProgress:!0,isMakeAjaxRequest:!0})},function(e){return console.log(e),n.setState({isApiInProgress:!0,isMakeAjaxRequest:!0}),e});case 3:return e.a(2)}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.props,n=t.isSaving,i=t.isPostInWorkflow,a=this.state,s=a.validationErrors,c=a.isLastStep,u=a.lastStepDecision,l=a.hideSignOff,f=a.signoffButtonText,p=a.assignActorLabel,d=a.dueDateLabel,h=a.displayDueDate,m=a.redirectingLoader,y=a.stepSpinner,w=a.assigneeSpinner,b=a.submitSpinner,g=a.submitButtonDisable;return l&&"show"===m?React.createElement("div",null,React.createElement(W.PanelBody,null,(0,o.__)("redirecting...","oasisworkflow"))):!i||l?"":React.createElement(W.PanelBody,{ref:this.signoffPanelRef,initialOpen:!0,title:f},React.createElement("form",{className:"reusable-block-edit-panel"},0!==s.length?React.createElement("div",{id:"owf-error-message",className:"notice notice-error is-dismissible"},s.map(function(e){return React.createElement("p",{key:e},e)})):"",React.createElement(W.SelectControl,{label:(0,o.__)("Action","oasisworkflow")+":",value:this.state.selectedAction,options:this.state.actions,onChange:this.getSignoffSteps.bind(this)}),c?React.createElement(fn,{stepDecision:u,handleResponse:this.props.handleResponse}):React.createElement("div",null,React.createElement("div",{className:"owf-spinner"},"show"==y?React.createElement(W.Spinner,null):""),React.createElement(W.SelectControl,{label:(0,o.__)("Step","oasisworkflow")+":",value:this.state.selectedStep,options:this.state.signoffSteps,onChange:this.getSelectedStepDetails.bind(this)}),React.createElement(ut,{value:this.state.selectedPriority,onChange:this.handleOnPriorityChange.bind(this)}),React.createElement("div",null,React.createElement("div",{className:"owf-spinner"},"show"==w&&0==this.state.assignToAll?React.createElement(W.Spinner,null):""),this.state.assignToAll?"":React.createElement(W.SelectControl,{multiple:!0,className:"ow-multi-select",label:p+":",value:this.state.selectedAssignees,options:this.state.assignee,onChange:function(t){return e.setState({selectedAssignees:t})}})),""!==h?React.createElement(W.PanelRow,{className:"edit-post-post-schedule"},React.createElement("label",null,d+":"," "),React.createElement(W.Dropdown,{popoverProps:{placement:"bottom-end"},contentClassName:"edit-post-post-schedule__dialog owduedatepicker-dropdown",renderToggle:function(e){var t=e.onToggle,n=e.isOpen;return React.createElement(r.Fragment,null,React.createElement(W.Button,{type:"button",onClick:t,"aria-expanded":n,"aria-live":"polite",isLink:!0},React.createElement(tt,null)))},renderContent:function(){return React.createElement(et,null)}})):"",React.createElement(W.PanelRow,null,React.createElement(W.TextareaControl,{label:(0,o.__)("Comments","oasisworkflow")+":",value:this.state.comments,onChange:function(t){return e.setState({comments:t})}})),React.createElement(W.PanelRow,null,React.createElement(W.Button,{isPrimary:!0,isBusy:n,focus:"true",disabled:g,onClick:this.handleSignoff.bind(this)},f),React.createElement("div",{className:"owf-spinner"},"show"==b?React.createElement(W.Spinner,null):"")))))}}],i&&gn(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,i,s,p,h,y}(r.Component);const On=(0,M.compose)([(0,d.withSelect)(function(e){var t=e("core/editor"),n=t.getCurrentPostId,o=t.getEditedPostAttribute,r=e("plugin/oasis-workflow"),i=r.getDueDate,a=r.getOWSettings,s=r.getPostInWorkflow;return{postId:n(),postMeta:o("meta"),dueDate:i(),owSettings:a(),isPostInWorkflow:s()}}),(0,d.withDispatch)(function(e){return{onSave:e("core/editor").savePost,setDueDate:e("plugin/oasis-workflow").setDueDate}})])(Tn),Rn=function(e){return React.createElement("div",null,(0,o.__)("If this is a custom post type, check this page: ","oasisworkflow"),React.createElement("a",{target:"_blank",href:"https://www.oasisworkflow.com/documentation/working-with-workflows/custom-post-type-support"},"custom post type support"),(0,o.__)(" for more information on how to make custom post type work with Gutenberg Editor.","oasisworkflow"))},Dn=function(e){return React.createElement("div",null,(0,o.__)("Workflow support for published posts is available with Pro version. ","oasisworkflow"),React.createElement("a",{target:"_blank",href:"https://www.oasisworkflow.com/documentation/working-with-workflows/revise-published-content"},(0,o.__)("Click here","oasisworkflow")),(0,o.__)(" for more information.","oasisworkflow"))};function Cn(e){return Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cn(e)}var An,In,jn;function Nn(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,xn(o.key),o)}}function xn(e){var t=function(e){if("object"!=Cn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Cn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Cn(t)?t:t+""}function Ln(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Ln=function(){return!!e})()}function Bn(e){return Bn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Bn(e)}function Mn(e,t){return Mn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Mn(e,t)}if(((null===(An=window.OWBlockEditorVars)||void 0===An?void 0:An.wpVersion)||"").startsWith("6.5")){var Wn=n(309);In=Wn.PluginSidebar,jn=Wn.PluginSidebarMoreMenuItem}else{var Fn=n(656);In=Fn.PluginSidebar,jn=Fn.PluginSidebarMoreMenuItem}var Un=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t,n){return t=Bn(t),function(e,t){if(t&&("object"==Cn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ln()?Reflect.construct(t,n||[],Bn(e).constructor):t.apply(e,n))}(this,t,arguments)).pluginSettings=null,e.submitButtonText="",e.state={submitToWorkflowResponse:"",signOffResponse:"",hideSignoff:!1,actionHistoryId:c(),hideClaimButton:!0,hidePlugin:!0,hidePluginMessage:(0,o.__)("Loading...","oasisworkflow")},e.showWorkflowSideBar=e.showWorkflowSideBar.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mn(e,t)}(t,e),n=t,(i=[{key:"componentDidUpdate",value:function(e){(e.postId!==this.props.postId||e.postStatus!==this.props.postStatus)&&(this.props.postId&&this.props.isPublishedByStatus?this.setState({hidePlugin:!0,hidePluginMessage:React.createElement(Dn,null)}):this.state.hidePlugin&&this.setState({hidePlugin:!1,hidePluginMessage:""}))}},{key:"componentDidMount",value:function(){var e=this;if(this.props.postId&&this.props.isPublishedByStatus){var t=React.createElement(Dn,null);this.setState({hidePlugin:!0,hidePluginMessage:t})}else if(null!=this.props.postMeta)this.props.setIsPostInWorkflow({isPostInWorkflow:this.props.postMeta._oasis_is_in_workflow}),this.setState({submitToWorkflowResponse:"",signOffResponse:""}),this.state.actionHistoryId&&m()({path:"/oasis-workflow/v1/workflows/claim/actionHistoryId="+this.state.actionHistoryId,method:"GET"}).then(function(t){e.setState({hideClaimButton:t.is_hidden})},function(e){return console.log(e),e}),m()({path:"/oasis-workflow/v1/workflows/submit/checkRoleCapability/postId="+this.props.postId+"/postType="+this.props.postType,method:"GET"}).then(function(t){if(t.is_role_applicable&&t.can_submit_to_workflow){var n=e,r=setInterval(function(){s(n.props.owSettings)||s(n.props.userCap)||(clearInterval(r),n.setState({hidePlugin:!1,hidePluginMessage:""}))},500);if(t.can_skip_workflow&&!e.props.postMeta._oasis_original||([].forEach.bind(document.getElementsByClassName("editor-post-publish-panel__toggle"),function(e){e.style.display="none"})(),[].forEach.bind(document.getElementsByClassName("editor-post-publish-button"),function(e){e.style.display="none"})()),e.state.actionHistoryId&&e.props.onOpenSideBar("oasis-workflow-plugin/ow-workflow-sidebar"),!e.state.actionHistoryId&&!e.props.postMeta._oasis_is_in_workflow&&t.can_submit_to_workflow&&(e.submitButtonText=(0,o.__)("Submit to Workflow","oasisworkflow")+"...",0===document.getElementsByClassName("owf-submit-button-div").length)){var i=document.createElement("div");i.className="owf-submit-button-div",i.innerHTML='<button type="button" aria-label="'.concat(e.submitButtonText,'"\n\t\t\t\t\t\t\t\tclass="owf-submit-button components-button is-primary is-button is-large">\n\t\t\t\t\t\t\t\t').concat(e.submitButtonText,"</button>");var a=document.getElementsByClassName("edit-post-header__settings")[0]||document.getElementsByClassName("editor-header__settings")[0];if(a)for(var c=a.getElementsByTagName("*"),u=0;u<c.length;u++)if("function"==typeof c[u].className.indexOf&&-1!==c[u].className.indexOf("editor-post-publish-panel")){c[u].parentNode.insertBefore(i,c[u].nextSibling),document.getElementsByClassName("owf-submit-button")[0].onclick=e.showWorkflowSideBar;break}}}else{var l=(0,o.__)("Workflow actions are not available for this post type.","oasisworkflow");t.can_submit_to_workflow||(l=(0,o.__)("You are not allowed to submit to workflow.","oasisworkflow")),e.setState({hidePlugin:!0,hidePluginMessage:l})}},function(e){return console.log(e),e});else{var n=React.createElement(Rn,null);this.setState({hidePlugin:!0,hidePluginMessage:n})}}},{key:"showWorkflowSideBar",value:function(){this.props.onOpenSideBar("oasis-workflow-plugin/ow-workflow-sidebar")}},{key:"handleWorkflowAbortResponse",value:function(){this.setState({submitToWorkflowResponse:"",signOffResponse:""}),this.props.setIsPostInWorkflow({isPostInWorkflow:!1})}},{key:"handleSubmitToWorkflowResponse",value:function(e){this.setState({submitToWorkflowResponse:e.success_response}),document.getElementsByClassName("owf-submit-button")[0].classList.add("owf-guten-hidden"),this.props.setIsPostInWorkflow({isPostInWorkflow:e.post_is_in_workflow})}},{key:"handleSignoffResponse",value:function(e){this.setState({signOffResponse:e.success_response,hideSignoff:!0}),this.props.setIsPostInWorkflow({isPostInWorkflow:e.post_is_in_workflow})}},{key:"render",value:function(){var e=this,t=this.state,n=t.submitToWorkflowResponse,i=t.signOffResponse,a=t.actionHistoryId,s=t.hideClaimButton,c=(t.hideCompareButton,t.hidePlugin),u=t.hidePluginMessage,l=t.hideSignoff;return React.createElement(r.Fragment,null,React.createElement(jn,{target:"ow-workflow-sidebar"},(0,o.__)("Oasis Workflow","oasisworkflow")),React.createElement(In,{name:"ow-workflow-sidebar",title:(0,o.__)("Oasis Workflow","oasisworkflow")},c?React.createElement(W.PanelBody,null,React.createElement("div",{id:"owf-warning-message",className:"notice notice-error"},u)):React.createElement("div",null,React.createElement(Ut,{response:i}),React.createElement("div",null,!l&&null!==a&&s?React.createElement(On,{handleResponse:this.handleSignoffResponse.bind(this)}):""),React.createElement(Ut,{response:n}),React.createElement(jt,{handleResponse:this.handleSubmitToWorkflowResponse.bind(this)}),React.createElement(Xt,{isHidden:s,actionHistoryId:a,onClaim:function(){return e.setState(function(e){return{hideClaimButton:!e.hideClaimButton}})}}),React.createElement(Ke,{handleResponse:this.handleWorkflowAbortResponse.bind(this)}))))}}])&&Nn(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,i}(r.Component),Gn=(0,M.compose)([(0,d.withSelect)(function(e){var t=e("core/editor"),n=t.getCurrentPostId,o=t.getCurrentPostType,r=t.isCurrentPostPublished,i=t.isCurrentPostScheduled,a=t.getEditedPostAttribute,s=e("core/edit-post").getActiveGeneralSidebarName,c=e("plugin/oasis-workflow"),u=c.getOWSettings,l=c.getUserCapabilities,f=a("status");return{postId:n(),postType:o(),postMeta:a("meta"),postStatus:f,isPublishedByStatus:["publish","private","future"].includes(f),isCurrentPostPublished:r(),isCurrentPostScheduled:i(),activeGeneralSidebarName:s(),owSettings:u(),userCap:l()}}),(0,d.withDispatch)(function(e){return{onSave:e("core/editor").savePost,onOpenSideBar:e("core/edit-post").openGeneralSidebar,setIsPostInWorkflow:e("plugin/oasis-workflow").setIsPostInWorkflow}})])(Un);(0,F.registerPlugin)("oasis-workflow-plugin",{icon:p,render:Gn})})()})();